<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Maxwell Green&#39;s functions · AARMBEM.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">AARMBEM.jl</span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../theory/historicalbackground.html">History</a></li><li><a class="tocitem" href="../theory/theoreticalbackground.html">Theory</a></li><li><a class="tocitem" href="../theory/acronyms.html">Common acronyms</a></li></ul></li><li><span class="tocitem">Implementation Notes</span><ul><li><a class="tocitem" href="../implementation/units.html">Units</a></li><li><a class="tocitem" href="../implementation/matrixstorage.html">Matrix storage conventions</a></li><li><a class="tocitem" href="../implementation/datastructuresandtransformations.html">Data structures and rigid transformations</a></li><li><a class="tocitem" href="../implementation/performancenotes.html">Performance notes and required packages</a></li><li><a class="tocitem" href="../implementation/outputquantities.html">Output quantities</a></li><li><a class="tocitem" href="../implementation/ewaldwarning.html">Warning: Ewald summation</a></li></ul></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../usage/configfiles.html">Configuration files</a></li><li><a class="tocitem" href="../usage/transfiles.html">Transformation files</a></li><li><a class="tocitem" href="../usage/periodicfiles.html">Bloch periodicity files</a></li><li><a class="tocitem" href="../usage/freqkfiles.html">Frequency and Bloch wavevector files</a></li><li><a class="tocitem" href="../usage/CMDARGS.html">Command-line arguments</a></li><li><a class="tocitem" href="../usage/outfiles.html">Output file structure</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/guaninecytosinePEC.html">Guanine + cytosine + PEC plane</a></li><li><a class="tocitem" href="../examples/2grapheneVAC.html">Two identical parallel graphene sheets (vacuum)</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="CMDARGS.html">Command-line arguments</a></li><li><a class="tocitem" href="expintegral.html">Exponential integral function</a></li><li><a class="tocitem" href="genericmatrixvectorutils.html">Generic matrix and vector utilities</a></li><li class="is-active"><a class="tocitem" href="greensfunctions.html">Maxwell Green&#39;s functions</a><ul class="internal"><li><a class="tocitem" href="#Vacuum-Green&#39;s-function-1"><span>Vacuum Green&#39;s function</span></a></li><li><a class="tocitem" href="#Scattering-Green&#39;s-function-above-a-PEC-plane-at-z-0-1"><span>Scattering Green&#39;s function above a PEC plane at <span>$z = 0$</span></span></a></li><li><a class="tocitem" href="#Green&#39;s-function-matrix-assembly-routines-1"><span>Green&#39;s function matrix assembly routines</span></a></li></ul></li><li><a class="tocitem" href="periodicdata.html">Data structures and functions for Bloch periodicity</a></li><li><a class="tocitem" href="moldata.html">Molecular data structures and methods</a></li><li><a class="tocitem" href="transdata.html">Transformation data structures and methods</a></li><li><a class="tocitem" href="vdWRHT.html">vdW interactions and thermal radiation functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href="greensfunctions.html">Maxwell Green&#39;s functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="greensfunctions.html">Maxwell Green&#39;s functions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/psv2/AARMBEM.jl/blob/master/doc/src/api/greensfunctions.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Maxwell-Green&#39;s-functions-1"><a class="docs-heading-anchor" href="#Maxwell-Green&#39;s-functions-1">Maxwell Green&#39;s functions</a><a class="docs-heading-anchor-permalink" href="#Maxwell-Green&#39;s-functions-1" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="c" href="#c"><code>c</code></a> — <span class="docstring-category">Constant</span></header><section><div><p>The vacuum speed of light is a global constant (299792458 meters per second).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L1-L3">source</a></section></article><h2 id="Vacuum-Green&#39;s-function-1"><a class="docs-heading-anchor" href="#Vacuum-Green&#39;s-function-1">Vacuum Green&#39;s function</a><a class="docs-heading-anchor-permalink" href="#Vacuum-Green&#39;s-function-1" title="Permalink"></a></h2><p>This section of functions can be used outside of AARMBEM.jl.</p><article class="docstring"><header><a class="docstring-binding" id="GFVACGG!" href="#GFVACGG!"><code>GFVACGG!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGG!(GvacGG::AbstractArray{Complex{FT}, 2},
         startidx1::Integer, startidx2::Integer,
         freq::Union{FT, Complex{FT}}, blochk::Array{FT, 1},
         posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
         latticevecs::Array{FT, 2}, reciprocalvecs::Array{FT, 2},
         alphafield::FT, alphasource::FT,
         numdims::Integer) where FT&lt;:AbstractFloat</code></pre><p>Fill <code>GvacGG[startidx1:startidx1+2, startidx2:startidx2+2]</code> in-place with the 3-by-3 Green&#39;s function interaction tensor in vacuum at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, using the appropriate function for <code>numdims</code> periodic dimensions (with lattice parameters <code>latticevecs</code> for the real lattice vectors and <code>reciprocalvecs</code> for the reciprocal lattice vectors as appropriate). <code>numdims</code> must be 0, 1, or 2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L10-L29">source</a></section><section><div><pre><code class="language-none">GFVACGG!(GvacGG::AbstractArray{Complex{FT}, 2}, startidx1::Integer, startidx2::Integer,
         freq::Union{FT, Complex{FT}},
         posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
         alphafield::FT, alphasource::FT) where {FT&lt;:AbstractFloat}</code></pre><p>Fill <code>GvacGG[startidx1:startidx1+2, startidx2:startidx2+2]</code> in-place with the 3-by-3 Green&#39;s function interaction tensor in vacuum at frequency <code>freq</code>, corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, for nonperiodic geometries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L748-L761">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGG" href="#GFVACGG"><code>GFVACGG</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGG(freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
        posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
        latticevecs::AbstractArray{FT, 2}, reciprocalvecs::AbstractArray{FT, 2},
        alphafield::FT, alphasource::FT, numdims::Integer) where FT&lt;:AbstractFloat</code></pre><p>Return the 3-by-3 Green&#39;s function interaction tensor in vacuum at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, using the appropriate function for <code>numdims</code> periodic dimensions (with lattice parameters <code>latticevecs</code> for the real lattice vectors and <code>reciprocalvecs</code> for the reciprocal lattice vectors as appropriate). <code>numdims</code> must be 0, 1, or 2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L792-L807">source</a></section><section><div><pre><code class="language-none">GFVACGG(freq::Union{FT, Complex{FT}},
        posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
        alphafield::FT, alphasource::FT) where {FT&lt;:AbstractFloat}</code></pre><p>Return the 3-by-3 Green&#39;s function interaction tensor in vacuum at frequency <code>freq</code>, corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, for nonperiodic geometries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L966-L977">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGG_sca!" href="#GFVACGG_sca!"><code>GFVACGG_sca!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGG_sca!(GvacGG::AbstractArray{Complex{FT}, 2},
             startidx1::Integer, startidx2::Integer,
             freq::Union{FT, Complex{FT}}, blochk::Array{FT, 1},
             posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
             latticevecs::Array{FT, 2}, reciprocalvecs::Array{FT, 2},
             alphafield::FT, alphasource::FT,
             numdims::Integer) where FT &lt;: AbstractFloat</code></pre><p>Fill <code>GvacGG[startidx1:startidx1+2, startidx2:startidx2+2]</code> in-place with a 3-by-3 block of zeros, which is the scattering Green&#39;s function in vacuum by definition, irrespective of the other function arguments. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L56-L70">source</a></section><section><div><pre><code class="language-none">GFVACGG_sca!(GvacGG::AbstractArray{Complex{FT}, 2}, startidx1::Integer, startidx2::Integer,
             freq::Union{FT, Complex{FT}}, posfield::AbstractArray{FT, 1},
             possource::AbstractArray{FT, 1}, alphafield::FT,
             alphasource::FT) where {FT&lt;:AbstractFloat}</code></pre><p>Fill <code>GvacGG[startidx1:startidx1+2, startidx2:startidx2+2]</code> in-place with a 3-by-3 block of zeros, which is the scattering Green&#39;s function in vacuum by definition, irrespective of the other function arguments. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L769-L780">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGG_sca" href="#GFVACGG_sca"><code>GFVACGG_sca</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGG_sca(freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
            posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
            latticevecs::AbstractArray{FT, 2}, reciprocalvecs::AbstractArray{FT, 2},
            alphafield::FT, alphasource::FT,
            numdims::Integer) where {FT&lt;:AbstractFloat}</code></pre><p>Return a 3-by-3 block of zeros, which is the scattering Green&#39;s function in vacuum by definition, irrespective of the other function arguments. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L820-L831">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGG0!" href="#GFVACGG0!"><code>GFVACGG0!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGG0!(GvacGG::AbstractArray{Complex{FT}, 2},
          startidx1::Integer, startidx2::Integer,
          freq::Union{FT, Complex{FT}},
          posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
          alphafield::FT, alphasource::FT) where FT&lt;:AbstractFloat</code></pre><p>Fill <code>GvacGG[startidx1:startidx1+2,startidx2: startidx2+2]</code> in-place with the 3-by-3 Green&#39;s function interaction tensor in vacuum at frequency <code>freq</code> without spatial periodicity, corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L98-L112">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGG0" href="#GFVACGG0"><code>GFVACGG0</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGG0(freq::Union{FT, Complex{FT}},
         posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
         alphafield::FT, alphasource::FT) where FT&lt;:AbstractFloat</code></pre><p>Return the 3-by-3 Green&#39;s function interaction tensor in vacuum at frequency <code>freq</code> without spatial periodicity, corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L838-L849">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGG0_sca!" href="#GFVACGG0_sca!"><code>GFVACGG0_sca!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGG0_sca!(GvacGG::AbstractArray{Complex{FT}, 2},
              startidx1::Integer, startidx2::Integer,
              freq::Union{FT, Complex{FT}},
              posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
              alphafield::FT, alphasource::FT) where FT &lt;: AbstractFloat</code></pre><p>Fill <code>GvacGG[startidx1:startidx1+2, startidx2:startidx2+2]</code> in-place with a 3-by-3 block of zeros, which is the scattering Green&#39;s function in vacuum by definition, irrespective of the other function arguments. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L176-L188">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGG0_sca" href="#GFVACGG0_sca"><code>GFVACGG0_sca</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGG0_sca(freq::Union{FT, Complex{FT}}, posfield::AbstractArray{FT, 1},
             possource::AbstractArray{FT, 1}, alphafield::FT,
             alphasource::FT) where {FT&lt;:AbstractFloat}</code></pre><p>Return a 3-by-3 block of zeros, which is the scattering Green&#39;s function in vacuum by definition, irrespective of the other function arguments. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L860-L869">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGGcoincident!" href="#GFVACGGcoincident!"><code>GFVACGGcoincident!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGGcoincident!(GvacGG::AbstractArray{Complex{FT}, 2},
                   startidx1::Integer, startidx2::Integer,
                   freq::Union{FT, Complex{FT}}, alphafield::FT,
                   alphasource::FT) where FT&lt;:AbstractFloat</code></pre><p>Fill <code>GvacGG[startidx1:startidx1+2, startidx2:startidx2+2]</code> in-place with the 3-by-3 tensor block corresponding to vacuum Green&#39;s function interaction between two Gaussian basis functions, defined by respective atomic polarizabilities <code>alphasource</code> and <code>alphafield</code>, when their centers coincide; this quantity always has a finite imaginary part, and has a finite real part when <code>alphafield</code> and <code>alphasource</code> are not both zero (meaning at least one basis function has a finite width).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L213-L227">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGGcoincident" href="#GFVACGGcoincident"><code>GFVACGGcoincident</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGGcoincident(freq::Union{FT, Complex{FT}},
                  alphafield::FT, alphasource::FT) where FT&lt;:AbstractFloat</code></pre><p>Return the scalar (as the tensor is the scalar multiplied by the 3-by-3 identity) corresponding to vacuum Green&#39;s function interaction between two Gaussian basis functions, defined by respective atomic polarizabilities <code>alphasource</code> and <code>alphafield</code>, when their centers coincide; this quantity always has a finite imaginary part, and has a finite real part when <code>alphafield</code> and <code>alphasource</code> are not both zero (meaning at least one basis function has a finite width).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L874-L886">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGG1Ewald!" href="#GFVACGG1Ewald!"><code>GFVACGG1Ewald!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGG1Ewald!(GvacGG::AbstractArray{Complex{FT}, 2},
               startidx1::Integer, startidx2::Integer,
               freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
               posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
               latticevecs::AbstractArray{FT, 2},
               reciprocalvecs::AbstractArray{FT, 2},
               alphafield::FT, alphasource::FT) where FT&lt;:AbstractFloat</code></pre><p>Fill <code>GvacGG[startidx1:startidx1+2, startidx2:startidx2+2]</code> in-place with the 3-by-3 Green&#39;s function interaction tensor in vacuum at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, in 1 periodic dimension (with lattice parameters <code>latticevecs</code> for the real lattice vectors and <code>reciprocalvecs</code> for the reciprocal lattice vectors as appropriate). This is done via Ewald summation over Gaussian basis functions in 1 dimension.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The Ewald summation convergence parameters are hard-coded into this function, though they should work for most common cases.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L254-L278">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGG1Ewald" href="#GFVACGG1Ewald"><code>GFVACGG1Ewald</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGG1Ewald(freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
              posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
              latticevecs::AbstractArray{FT, 2},
              reciprocalvecs::AbstractArray{FT, 2},
              alphafield::FT, alphasource::FT) where FT&lt;:AbstractFloat</code></pre><p>Return the 3-by-3 Green&#39;s function interaction tensor in vacuum at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, in 1 periodic dimension (with lattice parameters <code>latticevecs</code> for the real lattice vectors and <code>reciprocalvecs</code> for the reciprocal lattice vectors as appropriate). This is done via Ewald summation over Gaussian basis functions in 1 dimension.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The Ewald summation convergence parameters are hard-coded into this function, though they should work for most common cases.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L896-L917">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGG2Ewald!" href="#GFVACGG2Ewald!"><code>GFVACGG2Ewald!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGG2Ewald!(GvacGG::AbstractArray{Complex{FT}, 2},
               startidx1::Integer, startidx2::Integer,
               freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
               posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
               latticevecs::AbstractArray{FT, 2},
               reciprocalvecs::AbstractArray{FT, 2},
               alphafield::FT, alphasource::FT) where FT&lt;:AbstractFloat</code></pre><p>Fill <code>GvacGG[startidx1:startidx1+2, startidx2:startidx2+2]</code> in-place with the 3-by-3 Green&#39;s function interaction tensor in vacuum at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, in 2 periodic dimensions (with lattice parameters <code>latticevecs</code> for the real lattice vectors and <code>reciprocalvecs</code> for the reciprocal lattice vectors as appropriate). This is done via Ewald summation over Gaussian basis functions in 2 dimensions.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The Ewald summation convergence parameters are hard-coded into this function, though they should work for most common cases.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L331-L355">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGG2Ewald" href="#GFVACGG2Ewald"><code>GFVACGG2Ewald</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGG2Ewald(freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
              posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
              latticevecs::AbstractArray{FT, 2},
              reciprocalvecs::AbstractArray{FT, 2}, alphafield::FT,
              alphasource::FT) where FT&lt;:AbstractFloat</code></pre><p>Return the 3-by-3 Green&#39;s function interaction tensor in vacuum at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, in 2 periodic dimensions (with lattice parameters <code>latticevecs</code> for the real lattice vectors and <code>reciprocalvecs</code> for the reciprocal lattice vectors as appropriate). This is done via Ewald summation over Gaussian basis functions in 2 dimensions.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The Ewald summation convergence parameters are hard-coded into this function, though they should work for most common cases.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L931-L952">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGGEwaldSR" href="#GFVACGGEwaldSR"><code>GFVACGGEwaldSR</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGGEwaldSR(freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
               posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
               latticevecs::AbstractArray{FT, 2},
               alphafield::FT, alphasource::FT, kappa::FT,
               N1max::Integer, N2max::Integer=0) where FT&lt;:AbstractFloat</code></pre><p>Return the short-range Ewald summation contribution to the 3-by-3 Green&#39;s function interaction tensor in vacuum at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, in 1 or 2 periodic dimensions (with lattice parameters <code>latticevecs</code> for the real lattice vectors as appropriate). The sums over the real lattice run over <code>-1*N1max:N1max</code> and <code>-1*N2max:N2max</code> along each lattice vector, and <code>kappa</code> is the Ewald cutoff parameter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L407-L424">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGGEwaldLR1D" href="#GFVACGGEwaldLR1D"><code>GFVACGGEwaldLR1D</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGGEwaldLR1D(freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
                 posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
                 reciprocalvec::AbstractArray{FT, 1},
                 alphafield::FT, alphasource::FT, kappa::FT,
                 Mmax::Integer, Smax::Integer) where FT&lt;:AbstractFloat</code></pre><p>Return the long-range Ewald summation contribution to the 3-by-3 Green&#39;s function interaction tensor in vacuum at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, in 1 periodic dimension (with lattice parameters <code>reciprocalvec</code> for the reciprocal lattice vector as appropriate). The sum over the reciprocal lattice runs over <code>-1*Mmax:Mmax</code>, the sum computing the series representation of the reciprocal lattice expression runs over <code>0:Smax</code>, and <code>kappa</code> is the Ewald cutoff parameter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L524-L542">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFVACGGEwaldLR2D" href="#GFVACGGEwaldLR2D"><code>GFVACGGEwaldLR2D</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFVACGGEwaldLR2D(freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
                 posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
                 reciprocalvecs::AbstractArray{FT, 2},
                 alphafield::FT, alphasource::FT, kappa::FT,
                 M1max::Integer, M2max::Integer) where FT&lt;:AbstractFloat</code></pre><p>Return the long-range Ewald summation contribution to the 3-by-3 Green&#39;s function interaction tensor in vacuum at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, in 2 periodic dimensions (with lattice parameters <code>reciprocalvecs</code> for the reciprocal lattice vectors as appropriate). The sum over the reciprocal lattice runs over <code>-1*M1max:M1max</code> and <code>-1*M2max:M2max</code> along each reciprocal lattice vector, and <code>kappa</code> is the Ewald cutoff parameter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFVACGG.jl#L644-L662">source</a></section></article><h2 id="Scattering-Green&#39;s-function-above-a-PEC-plane-at-z-0-1"><a class="docs-heading-anchor" href="#Scattering-Green&#39;s-function-above-a-PEC-plane-at-z-0-1">Scattering Green&#39;s function above a PEC plane at <span>$z = 0$</span></a><a class="docs-heading-anchor-permalink" href="#Scattering-Green&#39;s-function-above-a-PEC-plane-at-z-0-1" title="Permalink"></a></h2><p>This section of functions can be used outside of AARMBEM.jl.</p><article class="docstring"><header><a class="docstring-binding" id="GFPECGG!" href="#GFPECGG!"><code>GFPECGG!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFPECGG!(GscaGG::AbstractArray{Complex{FT}, 2},
         startidx1::Integer, startidx2::Integer,
         freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
         posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
         latticevecs::AbstractArray{FT, 2}, reciprocalvecs::AbstractArray{FT, 2},
         alphafield::FT, alphasource::FT, numdims::Integer) where FT&lt;:AbstractFloat</code></pre><p>Fill <code>GscaGG[startidx1:startidx1+2, startidx2:startidx2+2]</code> in-place with the 3-by-3 scattering Green&#39;s function interaction tensor above a perfect electrically conducting (PEC) plane (coplanar with the xy-plane) from the vacuum Green&#39;s function via image theory, at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, using the appropriate function for <code>numdims</code> periodic dimensions (with lattice parameters <code>latticevecs</code> for the real lattice vectors and <code>reciprocalvecs</code> for the reciprocal lattice vectors as appropriate). <code>numdims</code> must be 0, 1, or 2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFPECGG.jl#L5-L24">source</a></section><section><div><pre><code class="language-none">GFPECGG!(GscaGG::AbstractArray{Complex{FT}, 2},
         startidx1::Integer, startidx2::Integer,
         freq::Union{FT, Complex{FT}}, posfield::AbstractArray{FT, 1},
         possource::AbstractArray{FT, 1}, alphafield::FT,
         alphasource::FT) where {FT&lt;:AbstractFloat}</code></pre><p>Fill <code>GscaGG[startidx1:startidx1+2, startidx2:startidx2+2]</code> in-place with the 3-by-3 scattering Green&#39;s function interaction tensor above a perfect electrically conducting (PEC) plane (coplanar with the xy-plane) from the vacuum Green&#39;s function via image theory, at frequency <code>freq</code>, corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, for nonperiodic geometries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFPECGG.jl#L216-L231">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFPECGG" href="#GFPECGG"><code>GFPECGG</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFPECGG(freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
             posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
             latticevecs::AbstractArray{FT, 2}, reciprocalvecs::AbstractArray{FT, 2},
             alphafield::FT, alphasource::FT, numdims::Integer) where FT&lt;:AbstractFloat</code></pre><p>Return the 3-by-3 scattering Green&#39;s function interaction tensor above a perfect electrically conducting (PEC) plane (coplanar with the xy-plane) from the vacuum Green&#39;s function via image theory, at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, using the appropriate function for <code>numdims</code> periodic dimensions (with lattice parameters <code>latticevecs</code> for the real lattice vectors and <code>reciprocalvecs</code> for the reciprocal lattice vectors as appropriate). <code>numdims</code> must be 0, 1, or 2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFPECGG.jl#L244-L261">source</a></section><section><div><pre><code class="language-none">GFPECGG(freq::Union{FT, Complex{FT}}, posfield::AbstractArray{FT, 1},
        possource::AbstractArray{FT, 1}, alphafield::FT,
        alphasource::FT) where {FT&lt;:AbstractFloat}</code></pre><p>Return the 3-by-3 scattering Green&#39;s function interaction tensor above a perfect electrically conducting (PEC) plane (coplanar with the xy-plane) from the vacuum Green&#39;s function via image theory, at frequency <code>freq</code>, corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, for nonperiodic geometries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFPECGG.jl#L372-L385">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFPECGG0!" href="#GFPECGG0!"><code>GFPECGG0!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFPECGG0!(GscaGG::AbstractArray{Complex{FT}, 2},
          startidx1::Integer, startidx2::Integer,
          freq::Union{FT, Complex{FT}},
          posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
          alphafield::FT, alphasource::FT) where FT&lt;:AbstractFloat</code></pre><p>Fill <code>GscaGG[startidx1:startidx1+2, startidx2:startidx2+2]</code> in-place with the 3-by-3 scattering Green&#39;s function interaction tensor above a perfect electrically conducting (PEC) plane (coplanar with the xy-plane) from the vacuum Green&#39;s function via image theory, at frequency <code>freq</code> without spatial periodicity, corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFPECGG.jl#L45-L60">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFPECGG0" href="#GFPECGG0"><code>GFPECGG0</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFPECGG0(freq::Union{FT, Complex{FT}}, posfield::AbstractArray{FT, 1},
         possource::AbstractArray{FT, 1}, alphafield::FT,
         alphasource::FT) where FT&lt;:AbstractFloat</code></pre><p>Return the 3-by-3 scattering Green&#39;s function interaction tensor above a perfect electrically conducting (PEC) plane (coplanar with the xy-plane) from the vacuum Green&#39;s function via image theory, at frequency <code>freq</code> without spatial periodicity, corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFPECGG.jl#L274-L287">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFPECGG1Ewald!" href="#GFPECGG1Ewald!"><code>GFPECGG1Ewald!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFPECGG1Ewald!(GscaGG::AbstractArray{Complex{FT}, 2},
               startidx1::Integer, startidx2::Integer,
               freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
               posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
               latticevecs::AbstractArray{FT, 2},
               reciprocalvecs::AbstractArray{FT, 2},
               alphafield::FT, alphasource::FT) where FT&lt;:AbstractFloat</code></pre><p>Fill <code>GscaGG[startidx1:startidx1+2, startidx2:startidx2+2]</code> in-place with the 3-by-3 scattering Green&#39;s function interaction tensor above a perfect electrically conducting (PEC) plane (coplanar with the xy-plane) from the vacuum Green&#39;s function via image theory, at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, in 1 periodic dimension (with lattice parameters <code>latticevecs</code> for the real lattice vectors and <code>reciprocalvecs</code> for the reciprocal lattice vectors as appropriate). This is done via Ewald summation over Gaussian basis functions in 1 dimension.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The Ewald summation convergence parameters are hard-coded into this function, though they should work for most common cases.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFPECGG.jl#L90-L115">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFPECGG1Ewald" href="#GFPECGG1Ewald"><code>GFPECGG1Ewald</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFPECGG1Ewald(freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
              posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
              latticevecs::AbstractArray{FT, 2},
              reciprocalvecs::AbstractArray{FT, 2}, alphafield::FT,
              alphasource::FT) where FT&lt;:AbstractFloat</code></pre><p>Return the 3-by-3 scattering Green&#39;s function interaction tensor above a perfect electrically conducting (PEC) plane (coplanar with the xy-plane) from the vacuum Green&#39;s function via image theory, at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, in 1 periodic dimension (with lattice parameters <code>latticevecs</code> for the real lattice vectors and <code>reciprocalvecs</code> for the reciprocal lattice vectors as appropriate). This is done via Ewald summation over Gaussian basis functions in 1 dimension.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The Ewald summation convergence parameters are hard-coded into this function, though they should work for most common cases.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFPECGG.jl#L298-L321">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFPECGG2Ewald!" href="#GFPECGG2Ewald!"><code>GFPECGG2Ewald!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFPECGG2Ewald!(GscaGG::AbstractArray{Complex{FT}, 2},
               startidx1::Integer, startidx2::Integer,
               freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
               posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
               latticevecs::AbstractArray{FT, 2},
               reciprocalvecs::AbstractArray{FT, 2},
               alphafield::FT, alphasource::FT) where FT&lt;:AbstractFloat</code></pre><p>Fill <code>GscaGG[startidx1:startidx1+2, startidx2:startidx2+2]</code> in-place with the 3-by-3 scattering Green&#39;s function interaction tensor above a perfect electrically conducting (PEC) plane (coplanar with the xy-plane) from the vacuum Green&#39;s function via image theory, at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, in 2 periodic dimensions (with lattice parameters <code>latticevecs</code> for the real lattice vectors and <code>reciprocalvecs</code> for the reciprocal lattice vectors as appropriate). This is done via Ewald summation over Gaussian basis functions in 2 dimensions.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The Ewald summation convergence parameters are hard-coded into this function, though they should work for most common cases.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFPECGG.jl#L151-L176">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GFPECGG2Ewald" href="#GFPECGG2Ewald"><code>GFPECGG2Ewald</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">GFPECGG2Ewald(freq::Union{FT, Complex{FT}}, blochk::AbstractArray{FT, 1},
              posfield::AbstractArray{FT, 1}, possource::AbstractArray{FT, 1},
              latticevecs::AbstractArray{FT, 2},
              reciprocalvecs::AbstractArray{FT, 2}, alphafield::FT,
              alphasource::FT) where FT&lt;:AbstractFloat</code></pre><p>Return the 3-by-3 scattering Green&#39;s function interaction tensor above a perfect electrically conducting (PEC) plane (coplanar with the xy-plane) from the vacuum Green&#39;s function via image theory, at frequency <code>freq</code> and wavevector <code>blochk</code> (a 3-element vector), corresponding to source position <code>possource</code> and field position <code>posfield</code> (both 3-element vectors) described by Gaussian basis functions parameterized by real atomic polarizabilities <code>alphasource</code> and <code>alphafield</code> respectively, in 2 periodic dimensions (with lattice parameters <code>latticevecs</code> for the real lattice vectors and <code>reciprocalvecs</code> for the reciprocal lattice vectors as appropriate). This is done via Ewald summation over Gaussian basis functions in 2 dimensions.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The Ewald summation convergence parameters are hard-coded into this function, though they should work for most common cases.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/GFPECGG.jl#L335-L358">source</a></section></article><h2 id="Green&#39;s-function-matrix-assembly-routines-1"><a class="docs-heading-anchor" href="#Green&#39;s-function-matrix-assembly-routines-1">Green&#39;s function matrix assembly routines</a><a class="docs-heading-anchor-permalink" href="#Green&#39;s-function-matrix-assembly-routines-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="assemble1MolGvacinf!" href="#assemble1MolGvacinf!"><code>assemble1MolGvacinf!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assemble1MolGvacinf!(mySingleMolData::OneMol{FT}, myPeriodicData::PeriodicData{FT},
                     freq::Union{FT, Complex{FT}},
                     blochk::Array{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></pre><p>Assemble the Green&#39;s function interaction matrix of a single molecule in vacuum, <code>mySingleMolData.GvacGGinf</code>, in-place, at frequency <code>freq</code> and wavevector <code>blochk</code> using additional information from <code>myPeriodicData</code> to speed up the computation. In particular, if the periodic dimensionality is 0, then this matrix is symmetric (whether <code>freq</code> is imaginary or not). Even if the periodic dimensionality is not 0, if <code>freq</code> is strictly imaginary, then this matrix is Hermitian. Both of those cases allow for computing only the lower triangle of 3-by-3 blocks. Otherwise, the full matrix must be assembled.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function depends on <code>mySingleMolData.alpha0</code> having been initialized to the desired atomic susceptibilities at the same <code>freq</code> and <code>blochk</code>, but does not check this.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolAssembleGFGG.jl#L1-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assemble1MolGvacinfdiag!" href="#assemble1MolGvacinfdiag!"><code>assemble1MolGvacinfdiag!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assemble1MolGvacinfdiag!(mySingleMolData::OneMol{FT},
                         freq::Union{FT, Complex{FT}}) where FT&lt;:AbstractFloat</code></pre><p>Assemble the scalar coincident Green&#39;s function interaction matrix elements of a single molecule in vacuum, <code>mySingleMolData.GvacGGinfdiag</code>, in-place, at frequency <code>freq</code>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function depends on <code>mySingleMolData.alpha0</code> having been initialized to the desired atomic susceptibilities at the same <code>freq</code> (and wavevector), but does not check this.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolAssembleGFGG.jl#L81-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="subtract1MolalphainvGvac!" href="#subtract1MolalphainvGvac!"><code>subtract1MolalphainvGvac!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">subtract1MolalphainvGvac!(myMolData::OneMol{&lt;:AbstractFloat})</code></pre><p>Subtract the Green&#39;s function interaction matrix of a single molecule in vacuum, <code>myMolData.GvacGGinf</code>, in-place, from its inverse susceptibility <code>myMolData.alphainv</code>. Separately dispatch cases with versus without phonons.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function depends on <code>myMolData.alphainv</code> having been initialized to the desired molecular susceptibility at the same <code>freq</code> and <code>blochk</code>, but does not check this.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolAssembleGFGG.jl#L104-L117">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembleGscaMolBlock!" href="#assembleGscaMolBlock!"><code>assembleGscaMolBlock!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembleGscaMolBlock!(A::SharedArray{Complex{FT}, 2},
                      myAllMolData::MolSystem{&lt;:OneMol{FT}},
                      myTransData::TransData{FT}, nn1::Integer, nn2::Integer,
                      startidx1::Integer, startidx2::Integer,
                      myPeriodicData::PeriodicData{FT},
                      GFSCAGG!::Function, freq::Union{FT, Complex{FT}},
                      blochk::AbstractArray{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></pre><p>Assemble the scattering Green&#39;s function interaction matrix (evaluated via the function <code>GFSCAGG!</code>) between molecules <code>nn1</code> and <code>nn2</code> (sources evaluated in the latter, fields evaluated in the former), at frequency <code>freq</code> and wavevector <code>blochk</code>, using atomic polarizability and coordinate data respectively from <code>myAllMolData</code> and <code>myTransData</code>, and add the result in-place to the matrix block <code>A[startidx1:endidx1, startidx2:endidx2]</code> where <code>endidx1 - startidx1 + 1</code> is 3 times the number of atoms in molecule <code>nn1</code>, and likewise <code>endidx2 - startidx2 + 1</code> is 3 times the number of atoms in molecule <code>nn2</code>. If <code>nn1</code> and <code>nn2</code> are the same, the matrix block is symmetric if the periodic dimensionality is 0, or Hermitian if the periodic dimensionality is nonzero but <code>freq</code> is purely imaginary, so only the lower triangle of blocks is assembled. Otherwise, the full set of matrix blocks is assembled. </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If <code>GFSCAGG!</code> is the scattering Green&#39;s function of vacuum (returning a 3-by-3 block of zeros), namely <code>GFVACGG_sca!</code> or <code>GFVACGG0_sca!</code>, this function does nothing, saving on computations.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Currently, only <code>GFPECGG!</code> and <code>GFPECGG0!</code> are supported for <code>GFSCAGG!</code>, but this is not explicitly checked, and may change in future versions of this code.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function depends on <code>mySingleMolData.alpha0</code> having been initialized to the desired atomic susceptibilities at the same <code>freq</code> and <code>blochk</code>, as well as <code>myTransData.allAtomPos</code> having been modified to reflect the desired transformation, but does not check these.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolAssembleGFGG.jl#L129-L169">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="assembleGvacMolBlock!" href="#assembleGvacMolBlock!"><code>assembleGvacMolBlock!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">assembleGvacMolBlock!(A::AbstractArray{Complex{FT}, 2},
                      myAllMolData::MolSystem{&lt;:OneMol{FT}},
                      myTransData::TransData{FT}, nn1::Integer, nn2::Integer,
                      startidx1::Integer, startidx2::Integer,
                      myPeriodicData::PeriodicData{FT},
                      freq::Union{FT, Complex{FT}},
                      blochk::AbstractArray{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></pre><p>Assemble the vacuum Green&#39;s function interaction matrix (evaluated via the function <code>GFVACGG!</code>) between molecules <code>nn1</code> and <code>nn2</code> (sources evaluated in the latter, fields evaluated in the former), at frequency <code>freq</code> and wavevector <code>blochk</code>, using atomic polarizability and coordinate data respectively from <code>myAllMolData</code> and <code>myTransData</code>, and add the result in-place to the matrix block <code>A[startidx1:endidx1, startidx2:endidx2]</code> where <code>endidx1 - startidx1 + 1</code> is 3 times the number of atoms in molecule <code>nn1</code>, and likewise <code>endidx2 - startidx2 + 1</code> is 3 times the number of atoms in molecule <code>nn2</code>. If <code>nn1</code> and <code>nn2</code> are the same, the matrix block is symmetric if the periodic dimensionality is 0, or Hermitian if the periodic dimensionality is nonzero but <code>freq</code> is purely imaginary, so only the lower triangle of blocks is assembled. Otherwise, the full set of matrix blocks is assembled. </p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Use <code>assemble1MolGvacinf!</code> when <code>nn1</code> and <code>nn2</code> are the same, then stamp that into <code>A</code> as needed. Only use this when <code>nn1</code> and <code>nn2</code> are different.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function depends on <code>mySingleMolData.alpha0</code> having been initialized to the desired atomic susceptibilities at the same <code>freq</code> and <code>blochk</code>, as well as <code>myTransData.allAtomPos</code> having been modified to reflect the desired transformation, but does not check these.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolAssembleGFGG.jl#L305-L339">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="genericmatrixvectorutils.html">« Generic matrix and vector utilities</a><a class="docs-footer-nextpage" href="periodicdata.html">Data structures and functions for Bloch periodicity »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 27 May 2020 11:40">Wednesday 27 May 2020</span>. Using Julia version 1.0.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
