<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Molecular data structures and methods · AARMBEM.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">AARMBEM.jl</span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../theory/historicalbackground.html">History</a></li><li><a class="tocitem" href="../theory/theoreticalbackground.html">Theory</a></li><li><a class="tocitem" href="../theory/acronyms.html">Common acronyms</a></li></ul></li><li><span class="tocitem">Implementation Notes</span><ul><li><a class="tocitem" href="../implementation/units.html">Units</a></li><li><a class="tocitem" href="../implementation/matrixstorage.html">Matrix storage conventions</a></li><li><a class="tocitem" href="../implementation/datastructuresandtransformations.html">Data structures and rigid transformations</a></li><li><a class="tocitem" href="../implementation/performancenotes.html">Performance notes and required packages</a></li><li><a class="tocitem" href="../implementation/outputquantities.html">Output quantities</a></li><li><a class="tocitem" href="../implementation/ewaldwarning.html">Warning: Ewald summation</a></li></ul></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../usage/configfiles.html">Configuration files</a></li><li><a class="tocitem" href="../usage/transfiles.html">Transformation files</a></li><li><a class="tocitem" href="../usage/periodicfiles.html">Bloch periodicity files</a></li><li><a class="tocitem" href="../usage/freqkfiles.html">Frequency and Bloch wavevector files</a></li><li><a class="tocitem" href="../usage/CMDARGS.html">Command-line arguments</a></li><li><a class="tocitem" href="../usage/outfiles.html">Output file structure</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/guaninecytosinePEC.html">Guanine + cytosine + PEC plane</a></li><li><a class="tocitem" href="../examples/2grapheneVAC.html">Two identical parallel graphene sheets (vacuum)</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="CMDARGS.html">Command-line arguments</a></li><li><a class="tocitem" href="expintegral.html">Exponential integral function</a></li><li><a class="tocitem" href="genericmatrixvectorutils.html">Generic matrix and vector utilities</a></li><li><a class="tocitem" href="greensfunctions.html">Maxwell Green&#39;s functions</a></li><li><a class="tocitem" href="periodicdata.html">Data structures and functions for Bloch periodicity</a></li><li class="is-active"><a class="tocitem" href="moldata.html">Molecular data structures and methods</a><ul class="internal"><li><a class="tocitem" href="#Data-structures-1"><span>Data structures</span></a></li><li><a class="tocitem" href="#Frequency-independent-data-structure-initialization-functions-1"><span>Frequency-independent data structure initialization functions</span></a></li><li><a class="tocitem" href="#Frequency-dependent-polarizability-calculation-functions-1"><span>Frequency-dependent polarizability calculation functions</span></a></li></ul></li><li><a class="tocitem" href="transdata.html">Transformation data structures and methods</a></li><li><a class="tocitem" href="vdWRHT.html">vdW interactions and thermal radiation functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href="moldata.html">Molecular data structures and methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="moldata.html">Molecular data structures and methods</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/psv2/AARMBEM.jl/blob/master/doc/src/api/moldata.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Molecular-data-structures-and-methods-1"><a class="docs-heading-anchor" href="#Molecular-data-structures-and-methods-1">Molecular data structures and methods</a><a class="docs-heading-anchor-permalink" href="#Molecular-data-structures-and-methods-1" title="Permalink"></a></h1><h2 id="Data-structures-1"><a class="docs-heading-anchor" href="#Data-structures-1">Data structures</a><a class="docs-heading-anchor-permalink" href="#Data-structures-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="OneMol" href="#OneMol"><code>OneMol</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">OneMol{FT&lt;:AbstractFloat}</code></pre><p>Represent properties of a single molecule, with or without phonons, as an abstract type.</p><p>See also: <a href="moldata.html#OneMol_WithPhonons"><code>OneMol_WithPhonons{FT}</code></a>, <a href="moldata.html#OneMol_NoPhonons"><code>OneMol_NoPhonons{FT}</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolData.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OneMol_WithPhonons" href="#OneMol_WithPhonons"><code>OneMol_WithPhonons</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">OneMol_WithPhonons{FT} &lt;: OneMol{FT}</code></pre><p>Represent the properties of a single molecule of <span>$N$</span> atoms, with phonons.</p><p><code>numatoms</code> is an integer equal to the number of atoms <span>$N$</span>.</p><p><code>Qe</code>, <code>Me</code>, <code>Be</code>, <code>Ke</code>, <code>MI</code>, and <code>BI</code> are all <code>numatoms</code>-element real vectors.</p><p><code>KI</code> is a <code>3*numatoms</code>-by-<code>3*numatoms</code> real matrix.</p><p><code>molpos0</code> is a 3-by-<code>numatoms</code> matrix where <code>molpos0[:, p]</code> represents the coordinates of the atom labeled <span>$p$</span>.</p><p><code>molCOM</code> is a 3-element real vector containing the unweighted molecular center of mass.</p><p><code>alphainv</code> and <code>GvacGGinf</code> are <code>3*numatoms</code>-by-<code>3*numatoms</code> complex matrices respectively representing the inverse susceptibility and Green&#39;s function interaction matrix of the molecule in isolation in vacuum (allocated but uninitialized until a frequency and wavevector are specified).</p><p><code>alpha0</code> is a <code>numatoms</code>-element real vector of the atomic polarizabilities (allocated but uninitialized until a frequency and wavevector are specified).</p><p><code>alphae</code> is an <code>numatoms</code>-element complex vector of the purely electronic contributions to the polarizabilities, useful mainly for vdW computations (allocated but uninitialized until a frequency and wavevector are specified).</p><p><code>numblocks1</code> &amp; <code>numblocks2</code> are the integer numbers of neighboring unit cells that have nontrivial internuclear couplings to the central unit cell (each is 1 molecules that are not periodic in that direction or have no internuclear couplings/covalent bonds with neighboring unit cells in that direction).</p><p><code>blocklist1</code> &amp; <code>blocklist2</code> are range vectors indexing each unit cell block (each has the single element 0 for molecules that are not periodic in that direction or have no internuclear couplings/covalent bonds with neighboring unit cells in that direction).</p><p>See also: <a href="moldata.html#OneMol"><code>OneMol{FT}</code></a>, <a href="moldata.html#OneMol_NoPhonons"><code>OneMol_NoPhonons{FT}</code></a> </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolData.jl#L13-L53">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="OneMol_NoPhonons" href="#OneMol_NoPhonons"><code>OneMol_NoPhonons</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">OneMol_NoPhonons{FT} &lt;: OneMol{FT}</code></pre><p>Represent the properties of a single molecule of <span>$N$</span> atoms, without phonons.</p><p><code>numatoms</code> is an integer equal to the number of atoms <span>$N$</span>.</p><p><code>Qe</code>, <code>Me</code>, <code>Be</code>, and <code>Ke</code> are all <code>numatoms</code>-element real vectors.</p><p><code>molpos0</code> is a 3-by-<code>numatoms</code> matrix where <code>molpos0[:, p]</code> represents the coordinates of atom <span>$p$</span>.</p><p><code>molCOM</code> is a 3-element real vector containing the unweighted molecular center of mass.</p><p><code>alphainv</code> is a <code>numatoms</code>-element complex vector representing the local inverse susceptibility of each atom (allocated but uninitialized until a frequency and wavevector are specified).</p><p><code>GvacGGinf</code> is a <code>3*numatoms</code>-by-<code>3*numatoms</code> complex matrix representing the Green&#39;s function interaction matrix of the molecule in isolation in vacuum (allocated but uninitialized until a frequency and wavevector are specified).</p><p><code>alphae</code> is <code>1 ./ alphainv</code>, useful mainly for vdW computations (allocated but uninitialized until a frequency and wavevector are specified).</p><p><code>alpha0</code> is <code>abs.(alphae)</code>, representing real atomic polarizabilities (allocated but uninitialized until a frequency and wavevector are specified).</p><p>See also: <a href="moldata.html#OneMol"><code>OneMol{FT}</code></a>, <a href="moldata.html#OneMol_WithPhonons"><code>OneMol_WithPhonons{FT}</code></a> </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolData.jl#L80-L111">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MolSystem" href="#MolSystem"><code>MolSystem</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">MolSystem{T&lt;:OneMol{&lt;:AbstractFloat}}</code></pre><p>Represent the properties of a collection of molecules.</p><p><code>uniqueMolDataArray</code> contains data for each unique molecule.</p><p><code>nummols</code> is the total number of molecules (unique or not).</p><p><code>numatomslist</code> is the list of atoms in every molecule (unique or not).</p><p><code>cumnumatomslist</code> is the cumulative sum of the number of atoms in every molecule, to keep track of overall indexing.</p><p><code>dupemolinds</code> is the list of indices tracking duplicate molecules: -1 indicates it is the first instance of that molecule, while positive index <code>nn</code> (in the range <code>1:nummols</code>) points to <code>nn</code> as the molecule to be duplicated.</p><p><code>uniquemolinds</code> is complementary to <code>dupemolinds</code>, listing the index of each unique molecule in the set of unique molecules, or -1 if it is a duplicate molecule.</p><p>See also: <a href="moldata.html#OneMol"><code>OneMol{FT}</code></a>, <a href="moldata.html#OneMol_WithPhonons"><code>OneMol_WithPhonons{FT}</code></a>, <a href="moldata.html#OneMol_NoPhonons"><code>OneMol_NoPhonons{FT}</code></a> </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolData.jl#L130-L155">source</a></section></article><h2 id="Frequency-independent-data-structure-initialization-functions-1"><a class="docs-heading-anchor" href="#Frequency-independent-data-structure-initialization-functions-1">Frequency-independent data structure initialization functions</a><a class="docs-heading-anchor-permalink" href="#Frequency-independent-data-structure-initialization-functions-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="read1MolDataWithPhonons" href="#read1MolDataWithPhonons"><code>read1MolDataWithPhonons</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">read1MolDataWithPhonons(molstrarray::Array{&lt;:AbstractString, 1},
                        mollistfilename::AbstractString, T::DataType=Float64)</code></pre><p>Read a section of a configuration file <code>molstrarray</code> (an array of strings) corresponding to molecular data and return the data corresponding to that molecule, with phonons, of type <code>OneMol_WithPhonons{T}</code>. Create data types to use <code>T</code> (satisfying <code>T&lt;:AbstractFloat</code>) for storing floating-point numbers, and output any errors with reference to the configuration file <code>mollistfilename</code> (a string).</p><p>See also: <a href="moldata.html#OneMol"><code>OneMol{FT}</code></a>, <a href="moldata.html#OneMol_WithPhonons"><code>OneMol_WithPhonons{FT}</code></a> </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolData.jl#L399-L412">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="read1MolDataNoPhonons" href="#read1MolDataNoPhonons"><code>read1MolDataNoPhonons</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">read1MolDataNoPhonons(molstrarray::Array{&lt;:AbstractString, 1},
                      mollistfilename::AbstractString, T::DataType=Float64)</code></pre><p>Read a section of a configuration file <code>molstrarray</code> (an array of strings) corresponding to molecular data and return the data corresponding to that molecule, without phonons, of type <code>OneMol_NoPhonons{T}</code>. Create data types to use <code>T</code> (satisfying <code>T&lt;:AbstractFloat</code>) for storing floating-point numbers, and output any errors with reference to the configuration file <code>mollistfilename</code> (a string).</p><p>See also: <a href="moldata.html#OneMol"><code>OneMol{FT}</code></a>, <a href="moldata.html#OneMol_NoPhonons"><code>OneMol_NoPhonons{FT}</code></a> </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolData.jl#L446-L459">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="readMolSystem" href="#readMolSystem"><code>readMolSystem</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">readMolSystem(mollistfilename::AbstractString,
              nophonons:Bool, T::DataType=Float64)</code></pre><p>Read a configuration file <code>mollistfilename</code> (a string) to extract molecular data of type either <code>OneMol_NoPhonons{T}</code>, if <code>nophonons</code> is <code>true</code>, or <code>OneMol_WithPhonons{T}</code> otherwise, returning information about the composite system of type <code>MolSystem{molType{T}}</code>. Ensure data types use <code>T</code> (satisfying <code>T&lt;:AbstractFloat</code>) for storing floating-point numbers.</p><p>See also: <a href="moldata.html#OneMol"><code>OneMol{T}</code></a>, <a href="moldata.html#OneMol_WithPhonons"><code>OneMol_WithPhonons{T}</code></a>, <a href="moldata.html#OneMol_NoPhonons"><code>OneMol_NoPhonons{T}</code></a>, <a href="moldata.html#MolSystem"><code>MolSystem{molType{T}}</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolData.jl#L479-L493">source</a></section></article><h2 id="Frequency-dependent-polarizability-calculation-functions-1"><a class="docs-heading-anchor" href="#Frequency-dependent-polarizability-calculation-functions-1">Frequency-dependent polarizability calculation functions</a><a class="docs-heading-anchor-permalink" href="#Frequency-dependent-polarizability-calculation-functions-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="constructMolAlpha!-Union{Tuple{FT}, Tuple{OneMol_WithPhonons{FT},PeriodicData{FT},Union{Complex{FT}, FT}}, Tuple{OneMol_WithPhonons{FT},PeriodicData{FT},Union{Complex{FT}, FT},Array{FT,1}}} where FT&lt;:AbstractFloat" href="#constructMolAlpha!-Union{Tuple{FT}, Tuple{OneMol_WithPhonons{FT},PeriodicData{FT},Union{Complex{FT}, FT}}, Tuple{OneMol_WithPhonons{FT},PeriodicData{FT},Union{Complex{FT}, FT},Array{FT,1}}} where FT&lt;:AbstractFloat"><code>constructMolAlpha!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">constructMolAlpha!(myMolData::OneMol_WithPhonons{FT},
                   myPeriodicData::PeriodicData{FT},
                   freq::Union{FT, Complex{FT}},
                   k::Array{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></pre><p>Construct the inverse molecular susceptibility <code>myMolData.alphainv</code> in-place at frequency <code>freq</code> and wavevector <code>k</code>, the latter of which must be a 3-element real vector. With phonons, <code>myMolData.alphainv</code> will be a matrix, the vector of atomic polarizabilities <code>myMolData.alpha0</code> will depend on the elements of <code>myMolData.alphainv</code>, and <code>myMolData.alphae</code> will be independent of these two. Without phonons, all three will be simply related to each other.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolAlpha.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="constructMolAlpha!-Union{Tuple{FT}, Tuple{OneMol_NoPhonons{FT},PeriodicData{FT},Union{Complex{FT}, FT}}, Tuple{OneMol_NoPhonons{FT},PeriodicData{FT},Union{Complex{FT}, FT},Array{FT,1}}} where FT&lt;:AbstractFloat" href="#constructMolAlpha!-Union{Tuple{FT}, Tuple{OneMol_NoPhonons{FT},PeriodicData{FT},Union{Complex{FT}, FT}}, Tuple{OneMol_NoPhonons{FT},PeriodicData{FT},Union{Complex{FT}, FT},Array{FT,1}}} where FT&lt;:AbstractFloat"><code>constructMolAlpha!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">constructMolAlpha!(myMolData::OneMol_NoPhonons{FT},
                   myPeriodicData::PeriodicData{FT},
                   freq::Union{FT, Complex{FT}},
                   k::Array{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></pre><p>Construct the inverse molecular susceptibility <code>myMolData.alphainv</code> in-place at frequency <code>freq</code> and wavevector <code>k</code>, the latter of which must be a 3-element real vector. Without phonons, <code>myMolData.alphainv</code> will be a vector, and the vectors <code>myMolData.alpha0</code> and <code>myMolData.alphae</code> will be simply related to <code>myMolData.alphainv</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolAlpha.jl#L54-L66">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="KIk" href="#KIk"><code>KIk</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">KIk(myMolData::OneMol_WithPhonons{FT}, myPeriodicData::PeriodicData{FT},
    k::Array{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></pre><p>Construct the <code>k</code>-dependence of the internuclear spring constant matrix (only if phonons are present), and return the result. Return <code>myMolData.KI</code> if the geometry has no periodic dimensions.</p><p>See also: <a href="moldata.html#constructMolAlpha!-Union{Tuple{FT}, Tuple{OneMol_WithPhonons{FT},PeriodicData{FT},Union{Complex{FT}, FT}}, Tuple{OneMol_WithPhonons{FT},PeriodicData{FT},Union{Complex{FT}, FT},Array{FT,1}}} where FT&lt;:AbstractFloat"><code>constructMolAlpha!(myMolData::OneMol_WithPhonons{FT},                        myPeriodicData::PeriodicData{FT},                        freq::Union{FT, Complex{FT}},                        k::Array{FT, 1}=zeros(FT, 3)) where FT&lt;:AbstractFloat</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/psv2/AARMBEM.jl/blob/f766c11b5ac7ff9bb67b5df8a9a450983553b922/src/MolAlpha.jl#L81-L95">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="periodicdata.html">« Data structures and functions for Bloch periodicity</a><a class="docs-footer-nextpage" href="transdata.html">Transformation data structures and methods »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 27 May 2020 11:40">Wednesday 27 May 2020</span>. Using Julia version 1.0.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
