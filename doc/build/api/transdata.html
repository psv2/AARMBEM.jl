<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Transformation data structures and methods · AARMBEM.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">AARMBEM.jl</span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../theory/historicalbackground.html">History</a></li><li><a class="tocitem" href="../theory/theoreticalbackground.html">Theory</a></li><li><a class="tocitem" href="../theory/acronyms.html">Common acronyms</a></li></ul></li><li><span class="tocitem">Implementation Notes</span><ul><li><a class="tocitem" href="../implementation/units.html">Units</a></li><li><a class="tocitem" href="../implementation/matrixstorage.html">Matrix storage conventions</a></li><li><a class="tocitem" href="../implementation/datastructuresandtransformations.html">Data structures and rigid transformations</a></li><li><a class="tocitem" href="../implementation/performancenotes.html">Performance notes and required packages</a></li><li><a class="tocitem" href="../implementation/outputquantities.html">Output quantities</a></li><li><a class="tocitem" href="../implementation/ewaldwarning.html">Warning: Ewald summation</a></li></ul></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../usage/configfiles.html">Configuration files</a></li><li><a class="tocitem" href="../usage/transfiles.html">Transformation files</a></li><li><a class="tocitem" href="../usage/periodicfiles.html">Bloch periodicity files</a></li><li><a class="tocitem" href="../usage/freqkfiles.html">Frequency and Bloch wavevector files</a></li><li><a class="tocitem" href="../usage/CMDARGS.html">Command-line arguments</a></li><li><a class="tocitem" href="../usage/outfiles.html">Output file structure</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/guaninecytosinePEC.html">Guanine + cytosine + PEC plane</a></li><li><a class="tocitem" href="../examples/2grapheneVAC.html">Two identical parallel graphene sheets (vacuum)</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="CMDARGS.html">Command-line arguments</a></li><li><a class="tocitem" href="expintegral.html">Exponential integral function</a></li><li><a class="tocitem" href="genericmatrixvectorutils.html">Generic matrix and vector utilities</a></li><li><a class="tocitem" href="greensfunctions.html">Maxwell Green&#39;s functions</a></li><li><a class="tocitem" href="periodicdata.html">Data structures and functions for Bloch periodicity</a></li><li><a class="tocitem" href="moldata.html">Molecular data structures and methods</a></li><li class="is-active"><a class="tocitem" href="transdata.html">Transformation data structures and methods</a><ul class="internal"><li><a class="tocitem" href="#Generic-functions-1"><span>Generic functions</span></a></li><li><a class="tocitem" href="#Data-structures-and-associated-functions-1"><span>Data structures and associated functions</span></a></li></ul></li><li><a class="tocitem" href="vdWRHT.html">vdW interactions and thermal radiation functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href="transdata.html">Transformation data structures and methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="transdata.html">Transformation data structures and methods</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Transformation-data-structures-and-methods-1"><a class="docs-heading-anchor" href="#Transformation-data-structures-and-methods-1">Transformation data structures and methods</a><a class="docs-heading-anchor-permalink" href="#Transformation-data-structures-and-methods-1" title="Permalink"></a></h1><h2 id="Generic-functions-1"><a class="docs-heading-anchor" href="#Generic-functions-1">Generic functions</a><a class="docs-heading-anchor-permalink" href="#Generic-functions-1" title="Permalink"></a></h2><p>The functions in this section may be useful outside of AARMBEM.jl, and can be used independently in any case.</p><article class="docstring"><header><a class="docstring-binding" id="findCOM" href="#findCOM"><code>findCOM</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">findCOM(pos0, startatom=1, endatom=size(pos0, 2))</code></pre><p>Return the unweighted center of mass of a block <code>pos0[:, startatom:endatom]</code> of coordinates, where each column <code>pos0[:, p]</code> has 3 elements representing the Cartesian coordinates of a particle labeled <span>$p$</span>.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="translateCOM!" href="#translateCOM!"><code>translateCOM!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">translateCOM!(pos0, dispCOM, startatom=1, endatom=size(pos0, 2))</code></pre><p>Translate the block <code>pos0[:, startatom:endatom]</code> of coordinates in-place (overwriting it), where each column <code>pos0[:, p]</code> has 3 elements representing the Cartesian coordinates of a particle labeled <span>$p$</span> and <code>dispCOM</code> is a 3-element vector representing the displacement, such that for each <code>p</code> in the range, <code>pos0[:, p] .+= dispCOM</code>.</p><p>See also: <a href="transdata.html#translateCOM"><code>translateCOM</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="translateCOM" href="#translateCOM"><code>translateCOM</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">translateCOM(pos0, dispCOM, startatom=1, endatom=size(pos0, 2))</code></pre><p>Translate the block <code>pos0[:, startatom:endatom]</code> of coordinates not in-place, returning the result, where each column <code>pos0[:, p]</code> has 3 elements representing the Cartesian coordinates of a particle labeled <span>$p$</span> and <code>dispCOM</code> is a 3-element vector representing the displacement, such that for each <code>p</code> in the range, <code>pos0[:, p] .+= dispCOM</code>.</p><p>See also: <a href="transdata.html#translateCOM!"><code>translateCOM!</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="rotatecoords!" href="#rotatecoords!"><code>rotatecoords!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rotatecoords!(pos0, rotmat, startatom=1, endatom=size(pos0, 2))</code></pre><p>Rotate the block <code>pos0[:, startatom:endatom]</code> of coordinates in-place (overwriting it), where each column <code>pos0[:, p]</code> has 3 elements representing the Cartesian coordinates of a particle labeled <span>$p$</span> and <code>rotmat</code> is a 3-by-3 matrix representing the (alibi) rotation, such that for each <code>p</code> in the range, <code>pos0[:, p] .= rotmat * pos0[:, p]</code>.</p><p>See also: <a href="transdata.html#rotatecoords"><code>rotatecoords</code></a></p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function will not check whether <code>rotmat</code> is real and orthogonal. It is the responsibility of the caller to ensure that <code>rotmat</code> represents a physical rotation; otherwise, unexpected behavior could emerge.</p></div></div></div></section></article><article class="docstring"><header><a class="docstring-binding" id="rotatecoords" href="#rotatecoords"><code>rotatecoords</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rotatecoords(pos0, rotmat, startatom=1, endatom=size(pos0, 2))</code></pre><p>Rotate the block <code>pos0[:, startatom:endatom]</code> of coordinates not in-place, returning the result, where each column <code>pos0[:, p]</code> has 3 elements representing the Cartesian coordinates of a particle labeled <span>$p$</span> and <code>rotmat</code> is a 3-by-3 matrix representing the rotation, such that for each <code>p</code> in the range, <code>pos0[:, p] .= rotmat * pos0[:, p]</code>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function will not check whether <code>rotmat</code> is real and orthogonal. It is the responsibility of the caller to ensure that <code>rotmat</code> represents a physical rotation; otherwise, unexpected behavior could emerge.</p></div></div><p>See also: <a href="transdata.html#rotatecoords!"><code>rotatecoords!</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="rotate3Nmat!" href="#rotate3Nmat!"><code>rotate3Nmat!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rotate3Nmat!(A, rotmat, startatom=1, endatom=div(size(A, 2), 3))</code></pre><p>Rotate the contents in the diagonal block of the complex matrix <code>A[3*startatom-2:3*endatom, 3*startatom-2:3*endatom]</code> by rotating each 3-by-3 block therein by the 3-by-3 real orthogonal (alibi) rotation matrix <code>rotmat</code>; this is done in-place, overwriting <code>A</code>.</p><p>See also: <a href="transdata.html#rotate3Nmat"><code>rotate3Nmat</code></a></p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function will not check whether <code>rotmat</code> is real and orthogonal. It is the responsibility of the caller to ensure that <code>rotmat</code> represents a physical rotation; otherwise, unexpected behavior could emerge.</p></div></div></div></section></article><article class="docstring"><header><a class="docstring-binding" id="rotate3Nmat" href="#rotate3Nmat"><code>rotate3Nmat</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rotate3Nmat(A, rotmat, startatom=1, endatom=div(size(A, 2), 3))</code></pre><p>Rotate the contents in the diagonal block of the complex matrix <code>A[3*startatom-2:3*endatom, 3*startatom-2:3*endatom]</code> by rotating each 3-by-3 block therein by the 3-by-3 real orthogonal (alibi) rotation matrix <code>rotmat</code>; this is done not in-place, returning the result.</p><p>See also: <a href="transdata.html#rotate3Nmat!"><code>rotate3Nmat!</code></a></p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function will not check whether <code>rotmat</code> is real and orthogonal. It is the responsibility of the caller to ensure that <code>rotmat</code> represents a physical rotation; otherwise, unexpected behavior could emerge.</p></div></div></div></section></article><article class="docstring"><header><a class="docstring-binding" id="makeCOM0!" href="#makeCOM0!"><code>makeCOM0!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">makeCOM0!(pos0, startatom=1, endatom=size(pos0, 2))</code></pre><p>Translate the block <code>pos0[:, startatom:endatom]</code> of coordinates in-place (overwriting it) to have a center of mass of 0, where each column <code>pos0[:, p]</code> has 3 elements representing the Cartesian coordinates of a particle labeled <span>$p$</span>.</p><p>See also: <a href="transdata.html#makeCOM0"><code>makeCOM0</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="makeCOM0" href="#makeCOM0"><code>makeCOM0</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">makeCOM0(pos0, startatom=1, endatom=size(pos0, 2))</code></pre><p>Translate the block <code>pos0[:, startatom:endatom]</code> of coordinates not in-place, returning the result, to have a center of mass of 0, where each column <code>pos0[:, p]</code> has 3 elements representing the Cartesian coordinates of a particle labeled <span>$p$</span>.</p><p>See also: <a href="transdata.html#makeCOM0!"><code>makeCOM0!</code></a></p></div></section></article><h2 id="Data-structures-and-associated-functions-1"><a class="docs-heading-anchor" href="#Data-structures-and-associated-functions-1">Data structures and associated functions</a><a class="docs-heading-anchor-permalink" href="#Data-structures-and-associated-functions-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="TransData" href="#TransData"><code>TransData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">TransData{FT&lt;:AbstractFloat}</code></pre><p>Store information relevant to the particular geometrical configuration, not intrinsic to molecules themselves, involving rigid geometrical transformations (translations and rotations); this depends on the number of molecules <code>nummols</code> from <code>MolSystem{T&lt;:OneMol{&lt;:AbstractFloat}}</code>.</p><p><code>numTrans</code> is the number of transformations <span>$t$</span> (an integer).</p><p><code>transArray</code> is a <code>3*nummols</code>-by-<code>numTrans</code> real array where each 3-element vector <code>transArray[3*nn-2:3*nn, tt]</code> is the center-of-mass translation vector (relative to the baseline) for molecule <code>nn</code> in transformation labeled <code>tt</code>.</p><p><code>rotArray</code> is a <code>3*nummols</code>-by-<code>3*numTrans</code> real array where each 3-by-3 block <code>rotArray[3*nn-2:3*nn, 3*tt-2:3*tt]</code> is the center-of-mass rotation matrix (relative to the baseline) for molecule <code>nn</code> in transformation labeled <code>tt</code>.</p><p><code>transLabels</code> is a <code>numTrans</code>-element vector of strings labeling each transformation <code>tt</code>.</p><p><code>changedFromBefore</code> is an <code>nummols</code>-by-<code>numTrans</code> <code>BitArray</code> such that <code>changedFromBefore[nn, tt]</code> is <code>true</code> if molecule <code>nn</code> is transformed in transformation <code>tt</code> relative to transformation <code>tt - 1</code>, <code>false</code> otherwise.</p><p><code>allAtomPos</code> is the horizontal concatenation of atomic coordinates (initially unmodified, later modified, by transformations) across all molecules.</p><p><code>baselineTrans</code> is a <code>3*nummols</code>-element real vector where each 3-element vector <code>baselineTrans[3*nn-2:3*nn]</code> is the baseline center of mass coordinate for molecule <code>nn</code>.</p><p><code>baselineRot</code> is a <code>3*nummols</code>-by-3 real matrix where each 3-by-3 block <code>baselineRot[3*nn-2:3*nn,:]</code> is the baseline center of mass rotation matrix for the orientation of molecule <code>nn</code>. Note that for both <code>baselineRot</code> and <code>rotArray</code>, each 3-by-3 Cartesian rotation matrix is given as the transpose of the overall matrix <span>$Z_{1} Y_{2} X_{3}$</span> in the Tait–Bryan convention, where angle 1 is <span>$\psi$</span>, angle 2 is <span>$\theta$</span>, and angle 3 is <span>$\varphi$</span>. In particular, each rotation matrix is the product <span>$R_{z}(-\psi) R_{y}(-\theta) R_{x}(-\varphi)$</span>, where <span>$R_{i}(\alpha)$</span> is a standard alibi rotation about Cartesian axis <span>$\vec{e}_{i}$</span>; for example, <span>$R_{z}(\pi/2)$</span> multiplied on the left of the 3-element column <span>$(1, 0, 0)^{\top}$</span> yields <span>$(0, 1, 0)^{\top}$</span>, and on the left of <span>$(0, 1, 0)^{\top}$</span> yields <span>$(-1, 0, 0)^{\top}$</span>. Note also that in the file with name <code>translistfilename</code>, the angles for each baseline orientation as well as each transformation beyond that must be listed in the order <code>phi</code> then <code>theta</code> then <code>psi</code>, in DEGREES.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="readTransData" href="#readTransData"><code>readTransData</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">readTransData(myMolData::MolSystem{&lt;:OneMol{FT}},
              translistfilename::AbstractString=&quot;&quot;) where FT&lt;:AbstractFloat</code></pre><p>Construct TransData from existing molecular data <code>myMolData</code> and a file of name <code>translistfilename</code> containing information about geometric transformations; if no file is specified, produce a default set of transformations (no displacements or rotations at all).</p><p>See also: <a href="moldata.html#MolSystem"><code>MolSystem{&lt;:OneMol{FT}}</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="initializeAtomPos!" href="#initializeAtomPos!"><code>initializeAtomPos!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">initializeAtomPos!(myTransData::TransData{FT},
                   myMolData::MolSystem{&lt;:OneMol{FT}}) where FT&lt;:AbstractFloat</code></pre><p>Initialize atomic coordinates across all molecules by first shifting coordinates of all molecules to have centers of mass of 0, then rotating all molecular coordinates according to baseline orientations of each, then translating to desired baseline centers of mass, modifying <code>myTransData</code> in-place.</p><p>See also: <a href="transdata.html#transformAtomPos!"><code>transformAtomPos!</code></a>, <a href="transdata.html#untransformAtomPos!"><code>untransformAtomPos!</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="transformAtomPos!" href="#transformAtomPos!"><code>transformAtomPos!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">transformAtomPos!(myTransData::TransData{FT},
                  myMolData::MolSystem{&lt;:OneMol{FT}},
                  tt::Integer) where FT&lt;:AbstractFloat</code></pre><p>Transform atomic coordinates across all molecules by first shifting coordinates of all molecules to have centers of mass of 0, then rotating all molecular coordinates according to orientations corresponding to transformation <code>tt</code> relative to the baseline, then translating to desired centers of mass corresponding to transformation <code>tt</code> relative to the baseline, modifying <code>myTransData</code> in-place.</p><p>See also: <a href="transdata.html#initializeAtomPos!"><code>initializeAtomPos!</code></a>, <a href="transdata.html#untransformAtomPos!"><code>untransformAtomPos!</code></a></p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="untransformAtomPos!" href="#untransformAtomPos!"><code>untransformAtomPos!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">untransformAtomPos!(myTransData::TransData{FT},
                    myMolData::MolSystem{&lt;:OneMol{FT}},
                    tt::Integer) where FT&lt;:AbstractFloat</code></pre><p>Undo transformation of atomic coordinates across all molecules by first shifting coordinates of all molecules to have centers of mass of 0, then rotating all molecular coordinates according to orientations corresponding to the opposites of transformation <code>tt</code> to return to the baseline, then translating back to the desired baseline centers of mass, modifying <code>myTransData</code> in-place.</p><p>See also: <a href="transdata.html#initializeAtomPos!"><code>initializeAtomPos!</code></a>, <a href="transdata.html#transformAtomPos!"><code>transformAtomPos!</code></a></p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="moldata.html">« Molecular data structures and methods</a><a class="docs-footer-nextpage" href="vdWRHT.html">vdW interactions and thermal radiation functions »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 19 May 2020 16:04">Tuesday 19 May 2020</span>. Using Julia version 1.0.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
