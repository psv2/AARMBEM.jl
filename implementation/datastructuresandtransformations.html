<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Data structures and rigid transformations · AARMBEM.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">AARMBEM.jl</span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../theory/historicalbackground.html">History</a></li><li><a class="tocitem" href="../theory/theoreticalbackground.html">Theory</a></li><li><a class="tocitem" href="../theory/acronyms.html">Common acronyms</a></li></ul></li><li><span class="tocitem">Implementation Notes</span><ul><li><a class="tocitem" href="units.html">Units</a></li><li><a class="tocitem" href="matrixstorage.html">Matrix storage conventions</a></li><li class="is-active"><a class="tocitem" href="datastructuresandtransformations.html">Data structures and rigid transformations</a><ul class="internal"><li><a class="tocitem" href="#Molecular-data-in-isolation-1"><span>Molecular data in isolation</span></a></li><li><a class="tocitem" href="#Rigid-transformations-1"><span>Rigid transformations</span></a></li></ul></li><li><a class="tocitem" href="performancenotes.html">Performance notes and required packages</a></li><li><a class="tocitem" href="outputquantities.html">Output quantities</a></li><li><a class="tocitem" href="ewaldwarning.html">Warning: Ewald summation</a></li></ul></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../usage/configfiles.html">Configuration files</a></li><li><a class="tocitem" href="../usage/transfiles.html">Transformation files</a></li><li><a class="tocitem" href="../usage/periodicfiles.html">Bloch periodicity files</a></li><li><a class="tocitem" href="../usage/freqkfiles.html">Frequency and Bloch wavevector files</a></li><li><a class="tocitem" href="../usage/CMDARGS.html">Command-line arguments</a></li><li><a class="tocitem" href="../usage/outfiles.html">Output file structure</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/guaninecytosinePEC.html">Guanine + cytosine + PEC plane</a></li><li><a class="tocitem" href="../examples/2grapheneVAC.html">Two identical parallel graphene sheets (vacuum)</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../api/CMDARGS.html">Command-line arguments</a></li><li><a class="tocitem" href="../api/expintegral.html">Exponential integral function</a></li><li><a class="tocitem" href="../api/genericmatrixvectorutils.html">Generic matrix and vector utilities</a></li><li><a class="tocitem" href="../api/greensfunctions.html">Maxwell Green&#39;s functions</a></li><li><a class="tocitem" href="../api/periodicdata.html">Data structures and functions for Bloch periodicity</a></li><li><a class="tocitem" href="../api/moldata.html">Molecular data structures and methods</a></li><li><a class="tocitem" href="../api/transdata.html">Transformation data structures and methods</a></li><li><a class="tocitem" href="../api/vdWRHT.html">vdW interactions and thermal radiation functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Implementation Notes</a></li><li class="is-active"><a href="datastructuresandtransformations.html">Data structures and rigid transformations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="datastructuresandtransformations.html">Data structures and rigid transformations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/psv2/AARMBEM.jl/blob/master/doc/src/implementation/datastructuresandtransformations.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Data-structures-and-rigid-transformations-1"><a class="docs-heading-anchor" href="#Data-structures-and-rigid-transformations-1">Data structures and rigid transformations</a><a class="docs-heading-anchor-permalink" href="#Data-structures-and-rigid-transformations-1" title="Permalink"></a></h1><p>This page describes the data structures used in AARMBEM.jl, as well as conventions for rigid transformations of molecular bodies. The basic idea is that for many EM scattering calculations, including vdW interaction energies and thermal radiation powers, data is needed at each frequency (and Bloch wavevector, if appropriate) and for many different geometric configurations, in which each geometric configuration consists of a set of rigid transformations applied to molecular and macroscopic bodies; as AARMBEM.jl currently only implements vacuum or the presence of a PEC plane at <span>$z = 0$</span> as the macroscopic body, all rigid transformations refer to those applied to molecular bodies. The data for each molecular body in isolation is independent of the rigid transformation, and therefore may be computed once per frequency (and Bloch wavevector, if appropriate); this has the additional benefit of being able to reuse data if multiple molecular bodies are used which are copies of each other in isolation. After this, data is computed for the Green&#39;s function and T-operator matrices <span>$G^{\mathrm{mac}}$</span> and <span>$T$</span> for each rigid transformation (which may include translations as well as proper rotations), efficiently reusing contributions from molecular data computed in isolation when possible. Further details are given in the remainder of this page.</p><h2 id="Molecular-data-in-isolation-1"><a class="docs-heading-anchor" href="#Molecular-data-in-isolation-1">Molecular data in isolation</a><a class="docs-heading-anchor-permalink" href="#Molecular-data-in-isolation-1" title="Permalink"></a></h2><p>In the RMB framework, every molecular body <span>$n$</span> is characterized by properties in isolation, including the number of atoms <span>$N_{n}$</span>, atomic coordinates <span>$\{\vec{r}_{p}\}$</span>, oscillator parameters, and atomic polarizabilities. In particular, as the charges, masses, damping coefficients, and valence electronic oscillator spring constants are all isotropic, they can efficiently be stored as <span>$N_{n}$</span>-element vectors; only the screened nuclear oscillator spring constants must be stored as a full <span>$3N_{n} \times 3N_{n}$</span> matrix. From these quantities, the polarizability matrix <span>$\alpha_{n}$</span> may be computed once per frequency (and Bloch wavevector, if appropriate). Furthermore, the diagonal molecular block of the vacuum Green&#39;s function matrix <span>$G^{(0)}_{nn}$</span> for each molecular body <span>$n$</span> likewise only depends on the relative positions of atoms in that body, not on absolute positions in space, and is therefore independent of rigid transformations, requiring computation only once per frequency (and Bloch wavevector, if appropriate).</p><p>Each molecular body can also be specified to have a certain <em>unweighted</em> center of mass position and a certain spatial orientation relative to the input data. Frequently, it may be desired to perform computations involving multiple molecular bodies that have entirely identical properties. It would be wasteful to duplicate molecular data in such a case, so the AARMBEM.jl code stores only data for unique molecular bodies, while separately storing only the centers of mass and orientations for each molecular body (distinguishing between otherwise identical molecular bodies). The polarizability and vacuum Green&#39;s function matrices <span>$\alpha_{n}$</span> and <span>$G^{(0)}_{nn}$</span> for each molecular body <span>$n$</span> in isolation are reused to construct the Green&#39;s function and T-operator matrices <span>$G^{\mathrm{mac}}$</span> and <span>$T$</span>, using appropriate rotation matrices to reproduce the desired orientations while translating the atomic coordinates back and forth accordingly.</p><h2 id="Rigid-transformations-1"><a class="docs-heading-anchor" href="#Rigid-transformations-1">Rigid transformations</a><a class="docs-heading-anchor-permalink" href="#Rigid-transformations-1" title="Permalink"></a></h2><p>Each molecular body has a baseline center of mass and a baseline orientation; if none are specified, the baseline center of mass is chosen to be the origin, and the baseline orientation is chosen to be unchanged from that corresponding to the input data for the atomic coordinates for that body. Each molecular body may also undergo translations of the center of mass and rigid rotations about the center of mass; the translation vectors are relative to the baseline center of mass, and the rotations are relative to the baseline orientation.</p><p>Rotations are specified through Euler angles <span>$(\varphi, \theta, \psi)$</span>. The particular convention used by AARMBEM.jl is that an atomic coordinate <span>$\vec{r}$</span>, represented by the column vector <span>$\begin{bmatrix} x, y, z \end{bmatrix}^{\top}$</span>, is transformed by a rotation into <span>$R_{z} (-\psi) R_{y} (-\theta) R_{x} (-\varphi) \begin{bmatrix} x, y, z \end{bmatrix}^{\top}$</span>. The rotation matrices are defined as</p><div>\[R_{x} (-\varphi) = \begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; \cos(\varphi) &amp; \sin(\varphi) \\
0 &amp; -\sin(\varphi) &amp; \cos(\varphi)
\end{bmatrix} \\
R_{y} (-\theta) = \begin{bmatrix}
\cos(\theta) &amp; 0 &amp; -\sin(\theta) \\
0 &amp; 1 &amp; 0 \\
\sin(\theta) &amp; 0 &amp; \cos(\theta)
\end{bmatrix} \\
R_{z} (-\psi) = \begin{bmatrix}
\cos(\psi) &amp; \sin(\psi) &amp; 0 \\
-\sin(\psi) &amp; \cos(\psi) &amp; 0 \\
0 &amp; 0 &amp; 1
\end{bmatrix}\]</div><p>in terms of these Euler angles.</p><p>The individual molecular matrices <span>$\alpha_{n}$</span> and <span>$G^{(0)}_{nn}$</span> are appropriately rotated before stamping into the diagonal blocks of <span>$G^{\mathrm{mac}}$</span> or <span>$T$</span>. This also accounts for the possibility that there may be molecular bodies with identical material properties but with different centers of mass or orientations (with only the latter having any effect on these matrices, with the correction being given through application of these rotation matrices as appropriate). This allows for efficient reuse of data, as computing the Green&#39;s function matrix elements is typically the computational bottleneck. Additionally, if a set of molecular bodies is not affected from one rigid transformation to the next, their diagonal and off-diagonal matrix blocks are not changed either. Rigid transformations are performed in a sorted order (regardless of the order specified), such that the displacement of the last molecular body changes first, then the displacement of the next-to-last molecular body, and so on, and then the orientation of the last molecular body, then the orientation of the next-to-last molecular body, and so on; this means that if there are many changes in position but few changes in orientation, as is often the case in many of these calculations, fewer transformations need to be applied and consequently fewer matrix blocks need to be recomputed.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="matrixstorage.html">« Matrix storage conventions</a><a class="docs-footer-nextpage" href="performancenotes.html">Performance notes and required packages »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 27 May 2020 15:53">Wednesday 27 May 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
