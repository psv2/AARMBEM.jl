<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theory · AARMBEM.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">AARMBEM.jl</span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="historicalbackground.html">History</a></li><li class="is-active"><a class="tocitem" href="theoreticalbackground.html">Theory</a><ul class="internal"><li><a class="tocitem" href="#Notation-1"><span>Notation</span></a></li><li><a class="tocitem" href="#Formulas-relevant-for-FED-1"><span>Formulas relevant for FED</span></a></li><li><a class="tocitem" href="#RMB-representation-of-EM-scattering-operators-1"><span>RMB representation of EM scattering operators</span></a></li></ul></li><li><a class="tocitem" href="acronyms.html">Common acronyms</a></li></ul></li><li><span class="tocitem">Implementation Notes</span><ul><li><a class="tocitem" href="../implementation/units.html">Units</a></li><li><a class="tocitem" href="../implementation/matrixstorage.html">Matrix storage conventions</a></li><li><a class="tocitem" href="../implementation/datastructuresandtransformations.html">Data structures and rigid transformations</a></li><li><a class="tocitem" href="../implementation/performancenotes.html">Performance notes and required packages</a></li><li><a class="tocitem" href="../implementation/outputquantities.html">Output quantities</a></li><li><a class="tocitem" href="../implementation/ewaldwarning.html">Warning: Ewald summation</a></li></ul></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../usage/configfiles.html">Configuration files</a></li><li><a class="tocitem" href="../usage/transfiles.html">Transformation files</a></li><li><a class="tocitem" href="../usage/periodicfiles.html">Bloch periodicity files</a></li><li><a class="tocitem" href="../usage/freqkfiles.html">Frequency and Bloch wavevector files</a></li><li><a class="tocitem" href="../usage/CMDARGS.html">Command-line arguments</a></li><li><a class="tocitem" href="../usage/outfiles.html">Output file structure</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/guaninecytosinePEC.html">Guanine + cytosine + PEC plane</a></li><li><a class="tocitem" href="../examples/2grapheneVAC.html">Two identical parallel graphene sheets (vacuum)</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../api/CMDARGS.html">Command-line arguments</a></li><li><a class="tocitem" href="../api/expintegral.html">Exponential integral function</a></li><li><a class="tocitem" href="../api/genericmatrixvectorutils.html">Generic matrix and vector utilities</a></li><li><a class="tocitem" href="../api/greensfunctions.html">Maxwell Green&#39;s functions</a></li><li><a class="tocitem" href="../api/periodicdata.html">Data structures and functions for Bloch periodicity</a></li><li><a class="tocitem" href="../api/moldata.html">Molecular data structures and methods</a></li><li><a class="tocitem" href="../api/transdata.html">Transformation data structures and methods</a></li><li><a class="tocitem" href="../api/vdWRHT.html">vdW interactions and thermal radiation functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Background</a></li><li class="is-active"><a href="theoreticalbackground.html">Theory</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="theoreticalbackground.html">Theory</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/psv2/AARMBEM.jl/blob/master/doc/src/theory/theoreticalbackground.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Theoretical-background-1"><a class="docs-heading-anchor" href="#Theoretical-background-1">Theoretical background</a><a class="docs-heading-anchor-permalink" href="#Theoretical-background-1" title="Permalink"></a></h1><p>This page explains the theoretical background for the RMB framework, and for its implementation in AARMBEM.jl. After explaining notation, the main formulas and assumptions are summarized, and then the implementation in AARMBEM.jl is explained; more details may be found in work by Venkataram et al <sup class="footnote-reference"><a id="citeref-VenkataramARXIV2020" href="#footnote-VenkataramARXIV2020">[VenkataramARXIV2020]</a></sup>.</p><h2 id="Notation-1"><a class="docs-heading-anchor" href="#Notation-1">Notation</a><a class="docs-heading-anchor-permalink" href="#Notation-1" title="Permalink"></a></h2><p>The following is a table of common notation used throughout this site, and particularly this page.</p><table><tr><th style="text-align: left">Notation</th><th style="text-align: left">Meaning</th><th style="text-align: left">Comments</th></tr><tr><td style="text-align: left"><span>$\vert\vec{v}\rangle$</span></td><td style="text-align: left"><span>$v_{i} (\vec{x})$</span></td><td style="text-align: left">semiclassical field, <em>not</em> second-quantized state</td></tr><tr><td style="text-align: left"><span>$\langle \vec{u}, \vec{v} \rangle$</span></td><td style="text-align: left"><span>$\sum_{i} \int u_{i}^{\star} (\vec{x}) v_{i} (\vec{x})~\mathrm{d}^{3} x$</span></td><td style="text-align: left">basis-independent conjugated inner product</td></tr><tr><td style="text-align: left"><span>$\mathbb{A}$</span></td><td style="text-align: left"><span>$A_{ij}(\vec{x}, \vec{x}&#39;)$</span></td><td style="text-align: left">integral kernel: <span>$\vert\vec{v}\rangle = \mathbb{A}\vert\vec{u}\rangle$</span> means <span>$v_{i}(\vec{x}) = \sum_{j} \int A_{ij}(\vec{x}, \vec{x}&#39;)u_{j}(\vec{x}&#39;)~\mathrm{d}^{3} x&#39;$</span></td></tr><tr><td style="text-align: left"><span>$\mathbb{I}$</span></td><td style="text-align: left"><span>$\delta_{ij} \delta^{3}(\vec{x} - \vec{x}&#39;)$</span></td><td style="text-align: left">identity operator</td></tr><tr><td style="text-align: left"><span>$\mathbb{P}_{n}$</span></td><td style="text-align: left"><span>$\delta_{ij} \delta^{3}(\vec{x} - \vec{x}&#39;) \Theta(\vec{x} \in V_{n})$</span></td><td style="text-align: left">projection onto material DOFs of body <span>$n$</span></td></tr><tr><td style="text-align: left"><span>$\mathbb{A}^{\dagger}$</span></td><td style="text-align: left"><span>$(\mathbb{A}^{\dagger})_{ij}(\vec{x}, \vec{x}&#39;) = A^{\star}_{ji}(\vec{x}&#39;, \vec{x})$</span></td><td style="text-align: left">Hermitian adjoint: basis-independent, <span>$\langle \vec{u}, \mathbb{A}^{\dagger} \vec{v} \rangle = \langle \mathbb{A} \vec{u}, \vec{v} \rangle$</span></td></tr><tr><td style="text-align: left"><span>$\operatorname{sym}(\mathbb{A})$</span></td><td style="text-align: left"><span>$(\mathbb{A} + \mathbb{A}^{\dagger})/2$</span></td><td style="text-align: left">Hermitian part for square operator</td></tr><tr><td style="text-align: left"><span>$\operatorname{asym}(\mathbb{A})$</span></td><td style="text-align: left"><span>$(\mathbb{A} - \mathbb{A}^{\dagger})/(2\mathrm{i})$</span></td><td style="text-align: left">anti-Hermitian part for square operator</td></tr><tr><td style="text-align: left"><span>$\mathbb{A}^{\top}$</span></td><td style="text-align: left"><span>$(\mathbb{A}^{\top})_{ij}(\vec{x}, \vec{x}&#39;) = A_{ji}(\vec{x}&#39;, \vec{x})$</span></td><td style="text-align: left">unconjugated transpose: basis-<em>dependent</em></td></tr><tr><td style="text-align: left"><span>$\mathbb{A}^{\star}$</span></td><td style="text-align: left"><span>$(\mathbb{A}^{\star})_{ij}(\vec{x}, \vec{x}&#39;) = A^{\star}_{ij}(\vec{x}, \vec{x}&#39;)$</span></td><td style="text-align: left">complex conjugate: basis-<em>dependent</em></td></tr><tr><td style="text-align: left"><span>$\operatorname{Re}(\mathbb{A})$</span></td><td style="text-align: left"><span>$(\mathbb{A} + \mathbb{A}^{\star})/2$</span></td><td style="text-align: left">real part</td></tr><tr><td style="text-align: left"><span>$\operatorname{Im}(\mathbb{A})$</span></td><td style="text-align: left"><span>$(\mathbb{A} - \mathbb{A}^{\star})/(2\mathrm{i})$</span></td><td style="text-align: left">imaginary part</td></tr><tr><td style="text-align: left"><span>$\mathbb{AB}$</span></td><td style="text-align: left"><span>$\sum_{l} \int A_{il}(\vec{x}, \vec{x}&#39;&#39;) B_{lj}(\vec{x}&#39;&#39;, \vec{x}&#39;)~\mathrm{d}^{3} x&#39;&#39;$</span></td><td style="text-align: left">operator product, <em>not</em> commutative</td></tr><tr><td style="text-align: left"><span>$\operatorname{Tr}[\mathbb{A}]$</span></td><td style="text-align: left"><span>$\sum_{i} \int A_{ii}(\vec{x}, \vec{x})~\mathrm{d}^{3} x$</span></td><td style="text-align: left">trace, basis-independent</td></tr></table><p>Note also that operators relevant to EM theory will commonly depend on the frequency <span>$\omega$</span> as a parameter; this will generally be suppressed in the notation for brevity, and context will make clear whether the dependence is on real frequency <span>$\omega$</span> versus imaginary frequency <span>$\omega = \mathrm{i}\xi$</span>. Furthermore, the Maxwell Green&#39;s function <span>$\mathbb{G}$</span> is defined to satisfy <span>$[\nabla \times (\nabla \times) - (\omega/c)^{2} (\mathbb{I} + \mathbb{V})]\mathbb{G} = (\omega/c)^{2} \mathbb{I}$</span> in the presence of a (possibly nonlocal, inhomogeneous, anisotropic) susceptibility <span>$\mathbb{V}$</span>, so that the solution in vacuum (<span>$\mathbb{V} \to 0$</span>) is <span>$G^{(0)}_{ij}(\vec{x}, \vec{x}&#39;) = [\partial_{i} \partial_{j} + (\omega/c)^{2} \delta_{ij}](e^{\mathrm{i}\omega\vert\vec{x} - \vec{x}&#39;\vert/c}/(4\pi\vert\vec{x} - \vec{x}&#39;\vert))$</span>, and this reproduces the field due to a static point dipole in the electrostatic (<span>$c \to \infty$</span>) limit.</p><h2 id="Formulas-relevant-for-FED-1"><a class="docs-heading-anchor" href="#Formulas-relevant-for-FED-1">Formulas relevant for FED</a><a class="docs-heading-anchor-permalink" href="#Formulas-relevant-for-FED-1" title="Permalink"></a></h2><p>AARMBEM.jl assumes that there exist <span>$N$</span> molecular bodies labeled <span>$n$</span> with susceptibilities <span>$\mathbb{V}_{n}$</span> that are separable/distinct/disjoint from each other (i.e. there are no inherent nonlocal correlations between bodies); this separability means the total susceptibility of the system may be written as a sum <span>$\mathbb{V} = \sum_{n = 1}^{N} \mathbb{V}_{n}$</span>. These interact in the presence of a macroscopic environment (which, for the implementation in AARMBEM.jl, may be vacuum or a PEC plane at <span>$z = 0$</span>) whose Maxwell Green&#39;s function is defined as <span>$\mathbb{G}^{\mathrm{mac}}$</span>; for convenience, the scattering Green&#39;s function will also be defined as <span>$\mathbb{G}^{\mathrm{sca}} = \mathbb{G}^{\mathrm{mac}} - \mathbb{G}^{(0)}$</span> (and this vanishes in vacuum).</p><p>Given these definitions, the most important quantity for EM scattering in general, and for FED phenomena in turn, is the T-operator, defined as <span>$\mathbb{T} = (\mathbb{V}^{-1} - \mathbb{G}^{\mathrm{mac}})^{-1} = (\mathbb{I} - \mathbb{V}\mathbb{G}^{\mathrm{mac}})^{-1} \mathbb{V}$</span>. This describes EM scattering to all orders within and between all bodies involved. It can be defined in block matrix form as</p><div>\[\mathbb{T}^{-1} =
\begin{bmatrix}
\mathbb{V}_{1}^{-1} - \mathbb{G}^{\mathrm{mac}}_{1,1} &amp; -\mathbb{G}^{\mathrm{mac}}_{1,2} &amp; -\mathbb{G}^{\mathrm{mac}}_{1,3} &amp; \ldots \\
-\mathbb{G}^{\mathrm{mac}}_{2,1} &amp; \mathbb{V}_{2}^{-1} - \mathbb{G}^{\mathrm{mac}}_{2,2} &amp; -\mathbb{G}^{\mathrm{mac}}_{2,3} &amp; \ldots \\
-\mathbb{G}^{\mathrm{mac}}_{3,1} &amp; -\mathbb{G}^{\mathrm{mac}}_{3,2} &amp; \mathbb{V}_{3}^{-1} - \mathbb{G}^{\mathrm{mac}}_{3,3} &amp; \ldots \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots
\end{bmatrix}\]</div><p>where the blocks <span>$\mathbb{G}^{\mathrm{mac}}_{mn} = \mathbb{P}_{m} \mathbb{G}^{\mathrm{mac}} \mathbb{P}_{n}$</span> are the projections of <span>$\mathbb{G}^{\mathrm{mac}}$</span> onto the DOFs of the molecules <span>$m$</span> and <span>$n$</span>. Also relevant to vdW interactions in particular is the quantity <span>$\mathbb{T}_{\infty}$</span>, which is the evaluation of <span>$\mathbb{T}$</span> when each molecular body is taken to be infinitely far away from every other molecular and macroscopic body (for which <span>$\mathbb{G}^{\mathrm{mac}}$</span> may be replaced by <span>$\mathbb{G}^{(0)}$</span>).</p><p>In terms of this, the vdW interaction free energy at thermal equilibrium is defined for temperature <span>$T$</span> as</p><div>\[\mathcal{F}(T) = k_{\mathrm{B}} T\sum_{l = 0}^{\infty} {}&#39; f(\mathrm{i}\xi_{l})\]</div><p>in terms of the integrand <span>$f(\mathrm{i}\xi) = \ln(\det[\mathbb{T}_{\infty} \mathbb{T}^{-1}])$</span> evaluated at the Matsubara frequencies <span>$\xi_{l} = 2\pi k_{\mathrm{B}} Tl/\hbar$</span>, where the prime over the summation implies an additional prefactor of <span>$1/2$</span> for the contribution <span>$l = 0$</span>; at <span>$T = 0$</span>, this turns into the integral <span>$\mathcal{F}(0) = \mathcal{E} = \hbar\int_{0}^{\infty} f(\mathrm{i}\xi)~\frac{\mathrm{d}\xi}{2\pi}$</span>.</p><p>The thermal radiation power may generally be defined as</p><div>\[P = \int_{0}^{\infty} W(\omega)~\frac{\mathrm{d}\omega}{2\pi}\]</div><p>in terms of an appropriate function <span>$W(\omega)$</span>; it is assumed that each body <span>$n$</span> is at a certain temperature <span>$T_{n}$</span>, and that these are immersed in an environment of temperature <span>$T_{\mathrm{env}}$</span> (which, for the implementation in AARMBEM.jl, is also the temperature of the PEC plane if present). For total thermal emission from a specific body <span>$m$</span>, the function is defined as</p><div>\[W^{(m)} = \sum_{n = 1}^{N} s_{nm} [\Pi(\omega, T_{n}) - \Pi(\omega,
T_{\mathrm{env}})]\Phi^{(m)}_{n}\]</div><p>in terms of the sign function <span>$s_{nm} = 1 - 2\delta_{nm}$</span>, while for net radiative heat transfer between bodies <span>$m$</span> and <span>$n$</span>, the function is defined as</p><div>\[W_{m \to n} = [\Pi(\omega, T_{m}) - \Pi(\omega,
T_{n})]\Phi^{(m)}_{n}\]</div><p>and both of these are defined in terms of the Planck function <span>$\Pi(\omega, T) = \hbar\omega/(e^{\hbar\omega/(k_{\mathrm{B}} T)} - 1)$</span> as well as the spectral function <span>$\Phi^{(m)}_{n} (\omega)$</span>. This spectral function is defined as</p><div>\[\Phi^{(m)}_{n} =
-4\operatorname{Tr}[\operatorname{asym}(\mathbb{V}_{m}^{-1\dagger})
\mathbb{P}_{m} \mathbb{T}^{\dagger} \operatorname{asym}(\mathbb{P}_{n}
\mathbb{G}^{\mathrm{mac}}) \mathbb{T} \mathbb{P}_{m}]\]</div><p>in terms of the aforementioned macroscopic Green&#39;s function and overall T-operators. Reciprocity means that it satisfies <span>$\Phi^{(m)}_{n} (\omega) = \Phi^{(n)}_{m} (\omega)$</span>.</p><p>These formulas are fully general, and when all bodies are compact (i.e. have well-defined finite dimensions in all directions appropriate for the problem at hand), these formulas require no further analytical manipulation. When all bodies have commensurate discrete translational symmetries in <span>$d \in \{1, 2\}$</span> dimensions, it is most useful to perform these computations imposing Bloch periodic boundary conditions in a unit cell of general volume (which in 1 dimension is a length, or in 2 dimensions is an area) <span>$V_{\mathrm{uc}}$</span>, and where Bloch wavevectors <span>$\vec{k}$</span> lie within the BZ. This means that we use as the vdW free energy integrand</p><div>\[f(\mathrm{i}\xi) = \int_{\mathrm{BZ}} f(\mathrm{i}\xi,
\vec{k})~\frac{V_{\mathrm{uc}}~\mathrm{d}^{d} k}{(2\pi)^{d}}\]</div><p>where <span>$f(\mathrm{i\xi}, \vec{k}) = \ln(\det[\mathbb{T}_{\infty} \mathbb{T}^{-1}])$</span> has all relevant operators evaluated at <span>$(\mathrm{i}\xi, \vec{k})$</span>; this will yield a vdW free energy per unit cell. Because <span>$(\mathbb{T}(\mathrm{i}\xi, \vec{k}))^{\top} = \mathbb{T}(\mathrm{i}\xi, -\vec{k})$</span> with a similar relation holding for <span>$\mathbb{T}_{\infty}$</span>, and the determinant is invariant with respect to transposition and for a product of operators is invariant with respect to their ordering, then <span>$f(\mathrm{i}\xi, \vec{k}) = f(\mathrm{i}\xi, -\vec{k})$</span>.  Similarly, we use as the thermal radiation power integrand</p><div>\[\Phi^{(m)}_{n} (\omega) = \int_{\mathrm{BZ}} \Phi^{(m)}_{n} (\omega,
\vec{k})~\frac{V_{\mathrm{uc}}~\mathrm{d}^{d} k}{(2\pi)^{d}}\]</div><p>where <span>$\Phi^{(m)}_{n}(\omega, \vec{k}) = -4\operatorname{Tr}[\operatorname{asym}(\mathbb{V}_{m}^{-1\dagger}) \mathbb{P}_{m} \mathbb{T}^{\dagger} \operatorname{asym}(\mathbb{P}_{n} \mathbb{G}^{\mathrm{mac}}) \mathbb{T} \mathbb{P}_{m}]$</span> has all relevant operators evaluated at <span>$(\omega, \vec{k})$</span>; this will yield a thermal radiation power per unit cell. Because the various operators are reciprocal, satisfying <span>$(\mathbb{A}(\omega, \vec{k}))^{\top} = \mathbb{A}(\omega, -\vec{k})$</span>, then <span>$\Phi^{(m)}_{n} (\omega, \vec{k}) = \Phi^{(n)}_{m} (\omega, -\vec{k})$</span>.</p><p>The following sections will discuss the details of the RMB framework in representing molecular polarization response functions to construct these operators in appropriate bases; these representations can be generalized to other EM scattering phenomena beyond FED phenomena, but the focus of AARMBEM.jl is on FED phenomena.</p><h2 id="RMB-representation-of-EM-scattering-operators-1"><a class="docs-heading-anchor" href="#RMB-representation-of-EM-scattering-operators-1">RMB representation of EM scattering operators</a><a class="docs-heading-anchor-permalink" href="#RMB-representation-of-EM-scattering-operators-1" title="Permalink"></a></h2><p>For any of these quantities to be computed, these operators require representations as matrices. As the molecular bodies are assumed to be disjoint, the total susceptibility is block-diagonal in the basis of molecular bodies. Given this, each molecular susceptibility may be expanded generically in a certain basis. For bodies that have atom-scale feature sizes but highly delocalized electronic response, the basis functions should be correspondingly delocalized in real space. The RMB framework in principle allows for this, but the AARMBEM.jl code has not implemented this. Instead, the AARMBEM.jl code implements a set of basis functions appropriate for insulating or weakly conducting media. This is described as follows.</p><h3 id="Susceptibilities-1"><a class="docs-heading-anchor" href="#Susceptibilities-1">Susceptibilities</a><a class="docs-heading-anchor-permalink" href="#Susceptibilities-1" title="Permalink"></a></h3><p>Appropriate for relatively localized electronic response, each molecular body has mapped onto itself a set of effective oscillator DOFs, specifically corresponding to one effective valence electronic oscillator and one effective screened nuclear oscillator for each atom. This means the susceptibility of each molecular body may be written as <span>$\mathbb{V}_{n} = \sum_{p,i,q,j} \alpha_{pi,qj} \vert\vec{f}_{pi}\rangle\langle\vec{f}_{qj}\vert$</span>, where the basis functions <span>$\vert\vec{f}_{pi}\rangle$</span> are chosen as appropriate localized functions, while the expansion coefficients <span>$\alpha_{pi,qj}$</span> are the elements of a matrix <span>$\alpha$</span> that are derived from oscillator equations of motion described as follows.</p><p>For each atom <span>$p$</span>, the valence electronic oscillator has an effective mass <span>$m_{\mathrm{e}p}$</span>, charge (coupling it to long-range EM fields) <span>$q_{\mathrm{e}p}$</span>, damping coefficient <span>$b_{\mathrm{e}p}$</span>, and isotropic spring constant (coupling it to its corresponding screened nuclear oscillator) <span>$k_{\mathrm{e}p}$</span>, while the screened nuclear oscillator at position <span>$\vec{r}_{p}$</span> does not couple directly to long-range EM fields due to screening by electrons but does have an effective mass <span>$m_{\mathrm{I}p}$</span>, damping coefficient <span>$b_{\mathrm{I}p}$</span>, and possibly anisotropic spring constants (coupling it to other nearby screened nuclear oscillators <span>$q$</span> along Cartesian directions <span>$i$</span> and <span>$j$</span>) <span>$K_{\mathrm{I}pi,qj}$</span>. These quantities are derived through a method briefly summarized as follows. The damping coefficients <span>$b_{\mathrm{e}p}$</span> and <span>$b_{\mathrm{I}p}$</span> may in principle be derived ab-initio, but especially in the regime of low loss, it is sufficient for users to specify them arbitrarily. The effective nuclear masses <span>$m_{\mathrm{I}p}$</span> are taken from elemental data. The remaining quantities are taken from density functional theory (DFT) calculations in the following way. The ground state electron density of the molecular body in isolation is computed using DFT, and the nuclear coordinates are relaxed to the lowest energy state; the Hessian of the ground state energy with respect to displacements in the nuclear spatial coordinates immediately yields the nuclear spring constants <span>$K_{\mathrm{I}pi,qj}$</span>, and the nuclear spatial coordinates <span>$\vec{r}_{p}$</span> are retained as well. The ground state electron density then undergoes a Hirshfeld partitioning to give effective electron densities around each atom, accounting for local chemical effects relative to the atom in isolation, and this is then combined with accurate reference data for the static polarizability of the atom in isolation to give a static polarizability for the atom within the molecule, which will be called <span>$\alpha_{\mathrm{e}p0}$</span>. The valence electronic oscillator has a polarizability <span>$\alpha_{\mathrm{e}p}(\omega) = \frac{\alpha_{\mathrm{e}p0}}{1 - (\omega/\omega_{\mathrm{e}p})^{2}}$</span>, with the frequency <span>$\omega_{\mathrm{e}p}$</span> taken from accurate reference data in an Unsoeld approximation. This is mapped to <span>$\alpha_{\mathrm{e}p}(\omega) = \frac{q_{\mathrm{e}p}^{2}}{k_{\mathrm{e}p} - \omega^{2} m_{\mathrm{e}p}}$</span> with the constraints <span>$q_{\mathrm{e}p} = N_{\mathrm{e}p} q_{\mathrm{e}}$</span> and <span>$m_{\mathrm{e}p} = N_{\mathrm{e}p} m_{\mathrm{e}}$</span> in terms of the known fundamental electron mass <span>$m_{\mathrm{e}}$</span> and charge <span>$q_{\mathrm{e}}$</span> to yield the total number of electrons <span>$N_{\mathrm{e}p}$</span> effectively constituting the valence electronic oscillator. Solving these equations yields <span>$q_{\mathrm{e}p} = \alpha_{\mathrm{e}p0} \omega_{\mathrm{e}p}^{2} m_{\mathrm{e}} / q_{\mathrm{e}}$</span>, <span>$m_{\mathrm{e}p} = \alpha_{\mathrm{e}p0} \omega_{\mathrm{e}p}^{2} m_{\mathrm{e}}^{2} / q_{\mathrm{e}}^{2}$</span>, and <span>$k_{\mathrm{e}p} = \alpha_{\mathrm{e}p0} \omega_{\mathrm{e}p}^{4} m_{\mathrm{e}}^{2} / q_{\mathrm{e}}^{2}$</span> in terms of <span>$\alpha_{\mathrm{e}p0}$</span> and <span>$\omega_{\mathrm{e}p}$</span> along with fundamental constants.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>AARMBEM.jl does <em>not</em> perform DFT calculations, nor does it look up reference data. All calculations required to compute <span>$\alpha_{\mathrm{e}p0}$</span>, <span>$\omega_{\mathrm{e}p}$</span>, and <span>$K_{\mathrm{I}pi,qj}$</span> must be done separately. Currently, this documentation does not provide further details in that regard.</p></div></div><p>Once these quantities are computed, they may be arranged into matrices. The nuclear spring constants <span>$K_{\mathrm{I}pi,qj}$</span> can naturally be arranged into a matrix <span>$K_{\mathrm{I}}$</span> due to the anisotropy and nonlocality of the couplings. The other quantities are isotropic and local (i.e. they do not involve couplings between different atoms), so quantities generally of the form <span>$a_{p}$</span> can be assembled as diagonal matrices <span>$A_{pi,qj} = a_{p} \delta_{pq} \delta_{ij}$</span>. These are then put together to yield the oscillator equations of motion</p><div>\[\begin{bmatrix}
K_{\mathrm{e}} - \operatorname{i}\omega B_{\mathrm{e}} - \omega^{2} M_{\mathrm{e}} &amp; -K_{\mathrm{e}} \\
-K_{\mathrm{e}} &amp; K_{\mathrm{e}} + K_{\mathrm{I}} - \operatorname{i}\omega B_{\mathrm{I}} - \omega^{2} B_{\mathrm{I}}
\end{bmatrix}
\begin{bmatrix}
Q_{\mathrm{e}}^{-1} p_{\mathrm{e}} \\
x_{\mathrm{I}}
\end{bmatrix}
=
\begin{bmatrix}
Q_{\mathrm{e}} e_{\mathrm{e}} \\
0
\end{bmatrix}\]</div><p>for which the relation <span>$p_{\mathrm{e}} = \alpha e_{\mathrm{e}}$</span> is then used to determine the polarizability matrix <span>$\alpha$</span> entering the susceptibility <span>$\mathbb{V}_{n}$</span>. Explicitly, the polarizability matrix is written as</p><div>\[\alpha = Q_{\mathrm{e}} (K_{\mathrm{e}} - \mathrm{i}\omega
B_{\mathrm{e}} - \omega^{2} M_{\mathrm{e}} - K_{\mathrm{e}}
(K_{\mathrm{e}} + K_{\mathrm{I}} - \mathrm{i}\omega B_{\mathrm{I}} -
\omega^{2} M_{\mathrm{I}})^{-1} K_{\mathrm{e}})^{-1} Q_{\mathrm{e}}\]</div><p>in terms of the aforementioned matrices.</p><p>The effective valence electronic oscillators are taken to be in their ground states, so with this in mind, the basis functions are chosen to be the oscillator ground state densities</p><div>\[\vec{f}_{pi}(\vec{x}) = \left(\sqrt{2\pi} \sigma_{p}\right)^{-3}
\exp\left(-\frac{(\vec{x} - \vec{r}_{p})^{2}}{2\sigma_{p}^{2}}\right)
\vec{e}_{i}\]</div><p>in each Cartesian direction <span>$\vec{e}_{i}$</span>. These are defined in terms of the aforementioned nuclear coordinates <span>$\vec{r}_{p}$</span> (arising from DFT) along with the Gaussian widths <span>$\sigma_{p}$</span>, which are not arbitrary but are chosen at each frequency to depend on the polarizability matrix in the following way: the definition <span>$\sigma_{p}(\omega) = (\alpha_{p}(\omega) / 3)^{1/3} / (2\sqrt{\pi})$</span> ensures that the internal self-energy of a Gaussian-distributed polarization is equal to the energy of its electrostatic self-interaction, and the definition <span>$\alpha_{p} (\omega) = \vert\sum_{q,j} \alpha_{pj,qj} (\omega)\vert/3$</span> takes the average over Cartesian polarization directions and transforms the nonlocal polarizability matrix into a set of effective screened atomic polarizabilities (with the absolute value ensuring real nonnegative Gaussian widths even at real <span>$\omega$</span>).</p><p>For compact bodies (i.e. having no dimensions of infinite extent) as well as for periodic bodies (i.e. having infinite extent with discrete translational symmetry in 1 or 2 dimensions), the matrices <span>$Q_{\mathrm{e}}$</span>, <span>$M_{\mathrm{e}}$</span>, <span>$B_{\mathrm{e}}$</span>, <span>$K_{\mathrm{e}}$</span>, <span>$M_{\mathrm{I}}$</span>, and <span>$B_{\mathrm{I}}$</span> are all diagonal nonnegative matrices (independent of the Bloch wavevector <span>$\vec{k}$</span> in the BZ for periodic bodies). For compact bodies, <span>$K_{\mathrm{I}}$</span> is a real-symmetric positive-semidefinite matrix, so <span>$K_{\mathrm{I}} = K_{\mathrm{I}}^{\top} = K_{\mathrm{I}}^{\dagger}$</span> (or, more explicitly, <span>$K_{\mathrm{I}pi,qj} = K_{\mathrm{I}pi,qj}^{\star} = K_{\mathrm{I}qj,pi}$</span>). This yields a reciprocal (but <em>not Hermitian, except at imaginary frequency</em> where it is real-symmetric positive-definite) polarizability matrix satisfying <span>$\alpha = \alpha^{\top}$</span> (or, more explicitly, <span>$\alpha_{pi,qj} = \alpha_{qj,pi}$</span>). For periodic bodies, evaluation of <span>$K_{\mathrm{I}\vec{k}}$</span> must be done for each Bloch wavevector <span>$\vec{k}$</span> in the BZ, and <span>$K_{\mathrm{I}\vec{k}}$</span> is a Hermitian positive-semidefinite matrix, so <span>$K_{\mathrm{I}\vec{k}} = (K_{\mathrm{I}\vec{k}})^{\dagger}$</span> (i.e. <span>$(K_{\mathrm{I}\vec{k}})^{\dagger}_{pi,qj} = K^{\star}_{\mathrm{I}\vec{k}qj,pi}$</span>), while reciprocity means that <span>$(K_{\mathrm{I}\vec{k}})^{\top} = K_{\mathrm{I}(-\vec{k})}$</span> (i.e. <span>$(K_{\mathrm{I}\vec{k}})^{\top}_{pi,qj} = K_{\mathrm{I}(-\vec{k})qj,pi}$</span>). This yields the reciprocity relation for the polarizability matrix of a periodic body, namely that <span>$(\alpha_{\vec{k}})^{\top} = \alpha_{-\vec{k}}$</span> (i.e. <span>$(\alpha_{\vec{k}})^{\top}_{pi,qj} = \alpha_{(-\vec{k})qj,pi}$</span>), while specifically at imaginary frequency <span>$\omega = \mathrm{i}\xi$</span>, <span>$\alpha_{\vec{k}}$</span> is a Hermitian positive-definite matrix, so <span>$\alpha_{\vec{k}} = \alpha_{\vec{k}}^{\dagger}$</span>.</p><h3 id="Green&#39;s-functions-1"><a class="docs-heading-anchor" href="#Green&#39;s-functions-1">Green&#39;s functions</a><a class="docs-heading-anchor-permalink" href="#Green&#39;s-functions-1" title="Permalink"></a></h3><p>Once the polarizability matrix is constructed, all that is left to represent the operators necessary for computing FED and other EM quantities is to represent the Green&#39;s functions in matrix form. In particular, the matrix elements <span>$\langle \vec{f}_{pi}, \mathbb{G}^{\mathrm{mac}} \vec{f}_{qj} \rangle$</span> are required. For a general macroscopic environment, this almost always requires costly six-dimensional cubature, and that is in the <em>easier</em> case of semianalytical expression of <span>$\mathbb{G}^{\mathrm{mac}}$</span>. For this reason, the only macroscopic environments currently supported in AARMBEM.jl are either vacuum or a single PEC plane at <span>$z = 0$</span>, because the matrix elements <span>$\langle \vec{f}_{pi}, \mathbb{G}^{(0)} \vec{f}_{qj} \rangle$</span> can be expressed analytically, and image theory allows using those expressions to determine <span>$\langle \vec{f}_{pi}, \mathbb{G}^{\mathrm{mac}} \vec{f}_{qj} \rangle$</span> in the presence of a PEC plane at <span>$z = 0$</span>.</p><h4 id="Compact-media-1"><a class="docs-heading-anchor" href="#Compact-media-1">Compact media</a><a class="docs-heading-anchor-permalink" href="#Compact-media-1" title="Permalink"></a></h4><p>For compact media, the matrix elements are computed directly in real space. In particular, they are written as</p><div>\[G^{(0)}_{pi,qj} = \langle \vec{f}_{pi}, \mathbb{G}^{(0)} \vec{f}_{qj}
\rangle = \left[\frac{\partial^{2}}{\partial r_{pi} \partial r_{pj}} +
(\omega/c)^{2} \delta_{ij}\right] \frac{\exp(-q^{2} /
4)}{8\pi\vert\vec{r}_{p} - \vec{r}_{q}\vert} \left[e^{\mathrm{i}\rho
q} \operatorname{erfc} \left(-\frac{\mathrm{iq}}{2} - \rho\right) -
e^{-\mathrm{i}\rho q} \operatorname{erfc} \left(-\frac{\mathrm{iq}}{2}
+ \rho\right)\right]\]</div><p>in terms of the complementary error function <span>$\operatorname{erfc}(u) = \frac{2}{\sqrt{\pi}} \int_{u}^{\infty} e^{-v^{2}}~\mathrm{d}v$</span>, and in terms of the definitions of the dimensionless variables <span>$q \equiv (\omega/c)\sqrt{2(\sigma_{p}^{2} + \sigma_{q}^{2})}$</span> and <span>$\rho \equiv \vert\vec{r}_{p} - \vec{r}_{q}\vert/\sqrt{2(\sigma_{p}^{2} + \sigma_{q}^{2})}$</span>. The diagonal elements <span>$G^{(0)}_{pi,pj}$</span> corresponding to the self-interaction of an oscillator in vacuum are taken to vanish when contribution to the T-operators for vdW interaction free energies or thermal radiation powers, but not in the contribution of the term <span>$\operatorname{asym}(\mathbb{P}_{n} \mathbb{G}^{\mathrm{mac}})$</span> to the thermal radiation power; the diagonal elements <span>$G^{\mathrm{sca}}_{pj,pj}$</span> in the presence of a PEC plane are never taken to vanish, as the corresponding vacuum interaction is with a physically separated image dipole, not with the original dipole in itself. All of these quantities may be evaluated at real <span>$\omega$</span> or at <span>$\omega = \mathrm{i}\xi$</span> for real nonnegative <span>$\xi$</span>. At real frequency <span>$\omega$</span>, the matrices <span>$G^{(0)}$</span> and <span>$G^{\mathrm{mac}}$</span> are reciprocal, meaning <span>$G^{(0)} = G^{(0)\top}$</span> and <span>$G^{\mathrm{mac}} = G^{\mathrm{mac}\top}$</span>; at imaginary frequency <span>$\omega = \mathrm{i}\xi$</span>, these matrices are real-valued as well.</p><h4 id="Periodic-media-1"><a class="docs-heading-anchor" href="#Periodic-media-1">Periodic media</a><a class="docs-heading-anchor-permalink" href="#Periodic-media-1" title="Permalink"></a></h4><p>For periodic media, the matrix elements <span>$G^{(0)}_{\vec{k}pi,qj} = \sum_{\vec{R}} e^{-\mathrm{i} \vec{k} \cdot \vec{R}} \langle \vec{f}_{p + \vec{R}, i}, \mathbb{G}^{(0)} \vec{f}_{qj} \rangle$</span> are needed in Bloch space, with Bloch wavevector <span>$\vec{k}$</span> restricted to lie in the BZ; here, <span>$\vert\vec{f}_{p+\vec{R},i}\rangle$</span> has position space representation <span>$\vec{f}_{pi}(\vec{x} - \vec{R})$</span>, where <span>$\vec{R}$</span> refers to a lattice vector. In any periodic dimensionality, it is useful to write <span>$G^{(0)}_{\vec{k}pi,qj} = G^{(0)\mathrm{SR}}_{\vec{k}pi,qj} + G^{(0)\mathrm{LR}}_{\vec{k}pi,qj}$</span> and make use of the Ewald summation procedure to efficiently contribute each of these two terms contributing to the sum. Further, in any periodic dimensionality, reciprocity means that <span>$(G^{(0)}_{\vec{k}})^{\top} = G^{(0)}_{-\vec{k}}$</span> at any frequency <span>$\omega$</span>, while at imaginary frequency <span>$\omega = \mathrm{i}\xi$</span>, <span>$(G^{(0)}_{\vec{k}})^{\dagger} = G^{(0)}_{\vec{k}}$</span>; these relations also hold for <span>$G^{(0)\mathrm{SR}}_{\vec{k}}$</span> and <span>$G^{(0)\mathrm{LR}}_{\vec{k}}$</span>, and for <span>$G^{\mathrm{mac}}_{\vec{k}}$</span> in the presence of a PEC plane at <span>$z = 0$</span>.</p><p>For either 1 or 2 periodic dimensions, given lattice vectors <span>$\vec{R}$</span>, the first contribution may be written at imaginary frequency <span>$\omega = \mathrm{i}\xi$</span> as</p><div>\[G^{(0)\mathrm{SR}}_{\vec{k}pi,qj} = \left[\frac{\partial^{2}}{\partial r_{pi} \partial r_{pj}} - (\xi/c)^{2} \delta_{ij}\right] \times \sum_{\vec{R}} \frac{e^{(\sigma_{p}^{2} + \sigma_{q}^{2})\xi^{2} / (2c^{2}) - \mathrm{i}\vec{k} \cdot \vec{R}}}{8\pi\vert\vec{r}_{p} + \vec{R} - \vec{r}_{q}\vert} \times \\
\left\{e^{-\rho\theta} \left[\operatorname{erfc}\left(\nu\rho - \frac{\theta}{2\nu}\right) - \operatorname{erfc}\left(\rho - \frac{\theta}{2}\right)\right] + e^{\rho\theta} \left[\operatorname{erfc}\left(\nu\rho + \frac{\theta}{2\nu}\right) - \operatorname{erfc}\left(\rho + \frac{\theta}{2}\right)\right]\right\}\]</div><p>having defined the dimensionless variables <span>$\rho \equiv \vert\vec{r}_{p} + \vec{R} - \vec{r}_{q}\vert/\sqrt{2(\sigma_{p}^{2} + \sigma_{q}^{2})}$</span> and <span>$\theta \equiv \sqrt{2(\sigma_{p}^{2} + \sigma_{q}^{2})}\xi/c$</span>, and where <span>$\nu \in [0, 1]$</span> is a dimensionless parameter that is ultimately chosen by the user for convergence. The expression at real frequency <span>$\omega$</span> can be obtained be consistently substituting <span>$\xi = -\mathrm{i}\omega$</span>.</p><p>For 1 periodic dimension, it shall be assumed that all lattice vectors can be written as <span>$\vec{R} = n\vec{a}$</span> for all integers <span>$n$</span> given a primitive lattice vector <span>$\vec{a} = a\vec{e}_{\vec{a}}$</span> (such that <span>$a = \vert\vec{a}\vert$</span> and <span>$\vec{e}_{\vec{a}} = \vec{a}/a$</span>), and the equation <span>$\vec{r}_{p} - \vec{r}_{q} = \Delta r_{\parallel} \vec{e}_{\vec{a}} + \Delta \vec{r}_{\perp}$</span> shall define <span>$\Delta r_{\parallel}$</span> and <span>$\Delta \vec{r}_{\perp}$</span>. Furthermore, the primitive reciprocal lattice vector is <span>$\vec{b} = 2\pi\vec{e}_{\vec{a}}/a$</span>, reciprocal lattice vectors will satisfy <span>$\vec{g} = n\vec{b}$</span> for all integers <span>$n$</span>, and <span>$\vec{k}$</span> in the BZ will lie along (or opposite to) <span>$\vec{e}_{\vec{a}}$</span>. At imaginary frequency <span>$\omega = \mathrm{i}\xi$</span>, this leads to the expression</p><div>\[G^{(0)\mathrm{LR}}_{\vec{k}pi,qj} = \frac{|\vec{b}|}{8\pi^{2}} \left[\frac{\partial^{2}}{\partial r_{pi} \partial r_{pj}} - (\xi/c)^{2} \delta_{ij}\right] \times \\
\sum_{\vec{g}} \left[\exp(\theta^{2} / 4 + \mathrm{i}(\vec{k} + \vec{g}) \cdot (\vec{r}_{p} - \vec{r}_{q})) \sum_{s = 0}^{\infty} \frac{(-1)^{s}}{s!} (\nu\rho_{\perp})^{2s} E_{s + 1} (\eta^{2} / (4\nu^{2}))\right]\]</div><p>written again in terms of <span>$\theta \equiv \sqrt{2(\sigma_{p}^{2} + \sigma_{q}^{2})}\xi/c$</span>, and where <span>$\nu \in [0, 1]$</span> is a dimensionless parameter that is ultimately chosen by the user for convergence, and also in terms of new dimensionless quantities <span>$\rho_{\perp} = \vert\Delta\vec{r}_{\perp}\vert/\sqrt{2(\sigma_{p}^{2} + \sigma_{q}^{2})}$</span> and <span>$\eta^{2} = \theta^{2} + 2(\sigma_{p}^{2} + \sigma_{q}^{2})\vert\vec{k} + \vec{g}\vert^{2}$</span>. Also used is the definition of the exponential integral function <span>$E_{s + 1}(x) = s^{-1} (e^{-x} - xE_{s}(x))$</span> given <span>$E_{1}(x) = \int_{x}^{\infty} t^{-1} e^{-t}~\mathrm{d}t$</span>. Once again, the expression at real frequency <span>$\omega$</span> can be obtained be consistently substituting <span>$\xi = -\mathrm{i}\omega$</span>.</p><p>For 2 periodic dimensions, it shall be assumed that all lattice vectors can be written as <span>$\vec{R} = n_{1} \vec{a}_{1} + n_{2} \vec{a}_{2}$</span> for all integer pairs <span>$(n_{1}, n_{2})$</span>, even if the primitive lattice vectors <span>$\vec{a}_{1}$</span> and <span>$\vec{a}_{2}$</span> are neither orthogonal nor unit-normalized. Furthermore, if the primitive lattice vectors are orthonormalized to yield a basis <span>$\vec{e}_{1}$</span> and <span>$\vec{e}_{2}$</span> defining the plane of periodicity and normal vector <span>$\vec{e}_{\perp}$</span>, then this allows for writing reciprocal lattice vectors <span>$\vec{g} = n_{1} \vec{b}_{1} + n_{2} \vec{b}_{2}$</span> for all integer pairs <span>$(n_{1}, n_{2})$</span> in terms of the primitive reciprocal lattice vectors <span>$\vec{b}_{1} = \frac{2\pi \vec{a}_{2} \times \vec{e}_{\perp}}{\vec{a}_{1} \cdot (\vec{a}_{2} \times \vec{e}_{\perp})}$</span> and <span>$\vec{b}_{2} = \frac{2\pi \vec{e}_{\perp} \times \vec{a}_{1}}{\vec{a}_{2} \cdot (\vec{e}_{\perp} \times \vec{a}_{1})}$</span>, and defining <span>$\vec{r}_{p} - \vec{r}_{q} = \Delta r_{1} \vec{e}_{1} + \Delta r_{2} \vec{e}_{2} + \Delta r_{\perp} \vec{e}_{\perp}$</span>. At imaginary frequency <span>$\omega = \mathrm{i}\xi$</span>, this leads to the expression</p><div>\[G^{(0)\mathrm{LR}}_{\vec{k}pi,qj} = \frac{\vert\vec{b}_{1} \times \vec{b}_{2}\vert}{16\pi^{2}} \left[\frac{\partial^{2}}{\partial r_{pi} \partial r_{pj}} - (\xi/c)^{2} \delta_{ij}\right] \times \\
\sum_{\vec{g}} \eta^{-1} \sqrt{2(\sigma_{p}^{2} + \sigma_{q}^{2})} \exp(\theta^{2} / 4 + \mathrm{i}(\vec{k} + \vec{g}) \cdot (\vec{r}_{p} - \vec{r}_{q})) \left[e^{-\eta\rho_{\perp}} \operatorname{erfc}\left(\frac{\eta}{2\nu} - \nu\rho_{\perp}\right) + e^{\eta\rho_{\perp}} \operatorname{erfc}\left(\frac{\eta}{2\nu} + \nu\rho_{\perp}\right)\right]\]</div><p>written again in terms of <span>$\theta \equiv \sqrt{2(\sigma_{p}^{2} + \sigma_{q}^{2})}\xi/c$</span> and <span>$\eta^{2} = \theta^{2} + 2(\sigma_{p}^{2} + \sigma_{q}^{2})\vert\vec{k} + \vec{g}\vert^{2}$</span>, and where <span>$\nu \in [0, 1]$</span> is a dimensionless parameter that is ultimately chosen by the user for convergence, and also in terms of new dimensionless quantity <span>$\rho_{\perp} = \Delta r_{\perp}/\sqrt{2(\sigma_{p}^{2} + \sigma_{q}^{2})}$</span> (which now may be negative). Once again, the expression at real frequency <span>$\omega$</span> can be obtained be consistently substituting <span>$\xi = -\mathrm{i}\omega$</span>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>In the above expressions, <span>$\nu \in [0, 1]$</span> must be consistently chosen and applied to computation of both <span>$G^{(0)\mathrm{SR}}$</span> and <span>$G^{(0)\mathrm{LR}}$</span>. Additionally, the implementation in AARMBEM.jl asks not for <span>$\nu$</span> but for a related quantity.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Convergence is quite sensitive to the choice of <span>$\nu$</span>, which will depend heavily on the geometric as well as material properties of the molecular body.</p></div></div><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-VenkataramARXIV2020"><a class="tag is-link" href="#citeref-VenkataramARXIV2020">VenkataramARXIV2020</a>Prashanth S. Venkataram, Jan Hermann, Alexandre Tkatchenko, and Alejandro W. Rodriguez. &quot;Fluctuational Electrodynamics in Atomic and Macroscopic Systems: van der Waals Interactions and Radiative Heat Transfer&quot;. <a href="https://arxiv.org/abs/2005.04083">arXiv:2005.04083</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="historicalbackground.html">« History</a><a class="docs-footer-nextpage" href="acronyms.html">Common acronyms »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 27 May 2020 11:40">Wednesday 27 May 2020</span>. Using Julia version 1.0.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
