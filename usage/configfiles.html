<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Configuration files · AARMBEM.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">AARMBEM.jl</span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../theory/historicalbackground.html">History</a></li><li><a class="tocitem" href="../theory/theoreticalbackground.html">Theory</a></li><li><a class="tocitem" href="../theory/acronyms.html">Common acronyms</a></li></ul></li><li><span class="tocitem">Implementation Notes</span><ul><li><a class="tocitem" href="../implementation/units.html">Units</a></li><li><a class="tocitem" href="../implementation/matrixstorage.html">Matrix storage conventions</a></li><li><a class="tocitem" href="../implementation/datastructuresandtransformations.html">Data structures and rigid transformations</a></li><li><a class="tocitem" href="../implementation/performancenotes.html">Performance notes and required packages</a></li><li><a class="tocitem" href="../implementation/outputquantities.html">Output quantities</a></li><li><a class="tocitem" href="../implementation/ewaldwarning.html">Warning: Ewald summation</a></li></ul></li><li><span class="tocitem">Usage</span><ul><li class="is-active"><a class="tocitem" href="configfiles.html">Configuration files</a><ul class="internal"><li><a class="tocitem" href="#Configuration-file-structure-1"><span>Configuration file structure</span></a></li><li><a class="tocitem" href="#Input-file-structure-1"><span>Input file structure</span></a></li></ul></li><li><a class="tocitem" href="transfiles.html">Transformation files</a></li><li><a class="tocitem" href="periodicfiles.html">Bloch periodicity files</a></li><li><a class="tocitem" href="freqkfiles.html">Frequency and Bloch wavevector files</a></li><li><a class="tocitem" href="CMDARGS.html">Command-line arguments</a></li><li><a class="tocitem" href="outfiles.html">Output file structure</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/guaninecytosinePEC.html">Guanine + cytosine + PEC plane</a></li><li><a class="tocitem" href="../examples/2grapheneVAC.html">Two identical parallel graphene sheets (vacuum)</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../api/CMDARGS.html">Command-line arguments</a></li><li><a class="tocitem" href="../api/expintegral.html">Exponential integral function</a></li><li><a class="tocitem" href="../api/genericmatrixvectorutils.html">Generic matrix and vector utilities</a></li><li><a class="tocitem" href="../api/greensfunctions.html">Maxwell Green&#39;s functions</a></li><li><a class="tocitem" href="../api/periodicdata.html">Data structures and functions for Bloch periodicity</a></li><li><a class="tocitem" href="../api/moldata.html">Molecular data structures and methods</a></li><li><a class="tocitem" href="../api/transdata.html">Transformation data structures and methods</a></li><li><a class="tocitem" href="../api/vdWRHT.html">vdW interactions and thermal radiation functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Usage</a></li><li class="is-active"><a href="configfiles.html">Configuration files</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="configfiles.html">Configuration files</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/psv2/AARMBEM.jl/blob/master/doc/src/usage/configfiles.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Molecular-configuration-files-1"><a class="docs-heading-anchor" href="#Molecular-configuration-files-1">Molecular configuration files</a><a class="docs-heading-anchor-permalink" href="#Molecular-configuration-files-1" title="Permalink"></a></h1><p>A major ingredient of running the command-line programs in AARMBEM.jl is the molecular configuration file. The structure of such a file is described in the following sections. As discussed in the page about command-line arguments, these calculations can be done including the effects of phonons (arising from displacements of the screened nuclear oscillators), but they can also be done in the absence of phonons, effectively taking the valence electronic oscillators to be coupled to fixed, rigid nuclei.</p><h2 id="Configuration-file-structure-1"><a class="docs-heading-anchor" href="#Configuration-file-structure-1">Configuration file structure</a><a class="docs-heading-anchor-permalink" href="#Configuration-file-structure-1" title="Permalink"></a></h2><p>The configuration file may have any file type, but it must be readable as plain text in a typical text editor. Given this, it is typical for the configuration file to have the <code>.txt</code> file type.</p><p>For <span>$N_{\mathrm{mol}}$</span> molecular bodies, the configuration file is made of <span>$N_{\mathrm{mol}}$</span> blocks defining the properties of each molecular body. A block is structured as in the following example.</p><pre><code class="language-none">MOL mol1
Qe Qefile.txt
Me Mefile.txt
Ke Kefile.txt
Be Befile.txt
MI MIfile.txt
BI BIfile.txt
KI KIfile.txt
xyz xyzfile.txt
Bescale 1.0
KIconst 1.0e3
KIconstatom1 1
KIconstatom2 2
ENDMOL</code></pre><p>In terms of formatting of this text block, leading and trailing spaces as well as blank lines are ignored. However, there are certain features that cannot be ignored or changed.</p><p>The first line defining a block must be the word <code>MOL</code> (case sensitive), followed by a space, followed by a string defining the molecular label (in this example <code>mol1</code>); this label string can be anything, but should, for ease of use, be somehow descriptive of the molecular body. The last line, before any new block starting with <code>MOL</code> is defined, must be <code>ENDMOL</code>.</p><p>The lines in between can be put in any order. For this molecule to be labeled <span>$n$</span>, the file used for constructing the matrices <span>$Q_{\mathrm{e}n}$</span> is specified as <code>Qefile.txt</code>, coming in the same line as <code>Qe</code> followed by exactly one space; no nonwhitespace characters are present after the specification of the file name. The corresponding files for <span>$M_{\mathrm{e}n}$</span>, <span>$K_{\mathrm{e}n}$</span>, <span>$B_{\mathrm{e}n}$</span>, <span>$M_{\mathrm{I}n}$</span>, <span>$B_{\mathrm{I}n}$</span>, <span>$K_{\mathrm{I}n}$</span>, and the atomic coordinates come respectively as <code>Mefile.txt</code>, <code>Kefile.txt</code>, <code>Befile.txt</code>, <code>MIfile.txt</code>, <code>BIfile.txt</code>, <code>KIfile.txt</code>, and <code>xyzfile.txt</code>, each respectively following the keywords <code>Me</code>, <code>Ke</code>, <code>Be</code>, <code>MI</code>, <code>BI</code>, <code>KI</code>, or <code>xyz</code> and (in each case) following exactly one space.</p><p>Of the above keywords, with or without phonons, the lines with <code>Qe</code>, <code>Me</code>, <code>Ke</code>, and <code>xyz</code> are required. With phonons, the keywords corresponding to the lines with <code>MI</code> and <code>KI</code> are required. With or without phonons, the keywords corresponding to the lines with <code>Be</code> and <code>BI</code> are always optional. If the line with <code>Be</code> is omitted, <span>$B_{\mathrm{e}n}$</span> is set to vanish, and likewise in the case with phonons, if the line with <code>BI</code> is omitted, <span>$B_{\mathrm{I}n}$</span> is set to vanish; that said, if both of these vanish, thermal radiation powers will vanish, as those require nontrivial material dissipation.</p><p>The line <code>Bescale bescaleval</code> allows for easily multiplying the matrix <span>$B_{\mathrm{e}n}$</span> by a uniform numerical factor <code>bescaleval</code>, which is a floating-point number that must correspond to a real nonnegative value (and may be written in scientific notation): that value <code>bescaleval</code> must follow the keyword <code>Bescale</code> and then exactly one space. In the above example, <code>bescaleval</code> is <code>1.0</code>. This is an optional keyword, and in its absence, <span>$B_{\mathrm{e}n}$</span> is unchanged from what is specified through the file associated with the keyword <code>Be</code>.</p><p>In the case with phonons, the line beginning with the keyword <code>KIconst</code> specifies an artificial spring constant to constrain one or two screened nuclear oscillators. This is useful for the following reason, as detailed later in this page. A physical spring constant matrix <span>$K_{\mathrm{I}n}$</span> for a collection of <span>$N_{n}$</span> atoms in 3 spatial dimensions will be real-symmetric positive-semidefinite, with exactly 6 eigenvalues that are zero, with 3 modes corresponding to inertial motion of the center of mass in each of the 3 Cartesian directions, and 3 modes corresponding to rigid rotation via Euler angles about the center of mass (though for an atomically-thin linear molecular body, like a carbyne wire, one of the rotational modes disappears, so there would only be 5 eigenvalues that vanish). These zero-frequency eigenvalues lead to divergence of the polarizability matrix <span>$\alpha_{n}$</span> as <span>$\omega \to 0$</span> (along the real or imaginary axes), which could potentially lead to problems particularly for vdW interaction free energies where the integrand at <span>$\omega = 0$</span> does not vanish. A useful way of squeezing out these modes is to artificially constrain two (for compact molecular bodies, or only one for molecular bodies with commensurate discrete translational symmetry) screened nuclear oscillators with extra spring constants; for compact molecular bodies, constraining the screened nuclear oscillators that are farthest apart from each other can effectively preserve the phonon dispersion properties of most of the molecule, but for periodically extended molecular bodies, constraints are generally not recommended as their periodic repetition for all unit cells will lead to spurious modifications to the material properties.</p><p>The artificial spring constant constraints may be specified in a few different ways; in each case, the value is given in units of newtons per meter. Also, this is an optional keyword: if that line is absent, the artificial spring constant is set by default to vanish. Following the keyword <code>KIconst</code> and then exactly one space, exactly 1, 3, 6, or 9 values may be specified. If the line is specified as <code>KIconst KIconst1</code>, where <code>KIconst1</code> is a real nonnegative number specified as a floating-point value (possibly with scientific notation), then the spring constant tensor is simply <code>KIconst1</code> multiplied by the 3-by-3 identity tensor, implying an isotropic coupling; in the example above, <code>KIconst1</code> is <code>1.0e3</code> (i.e. <span>$10^{3}~\mathrm{N/m}$</span>). If that value happens to be negative, its absolute value is taken. If the line is specified as <code>KIconst KIconst1 KIconst2 KIconst3</code>, then the values <code>KIconst1</code>, <code>KIconst2</code>, and <code>KIconst3</code> are respectively assigned as the <span>$xx$</span>-, <span>$yy$</span>-, and <span>$zz$</span>-components of a tensor that is diagonal in the basis of the Cartesian axis unit vectors; if any of these values are negative, their absolute values are used. If the line is specified as <code>KIconst KIconst1 KIconst2 KIconst3 KIconst4 KIconst5 KIconst6</code>, then the values <code>KIconst1</code>, <code>KIconst2</code>, <code>KIconst3</code>, <code>KIconst4</code>, <code>KIconst5</code>, and <code>KIconst6</code> are respectively assigned as the <span>$xx$</span>-, <span>$xy$</span>-, <span>$xz$</span>-, <span>$yy$</span>-, <span>$yz$</span>-, and <span>$zz$</span>-components of a general tensor, with the <span>$yx$</span>-, <span>$zx$</span>-, and <span>$zy$</span>-components respectively assigned to be the same as the <span>$xy$</span>-, <span>$xz$</span>-, and <span>$yz$</span>-components to ensure that the tensor is real-symmetric; once this is done, the eigenvalues and eigenvectors are found, any eigenvalues that are negative are replaced by their absolute values, and these are then multiplied by the corresponding eigenvector projection operators and added again to yield a real-symmetric positive-definite tensor spring constant constraint along general orthonormal axes in 3 dimensions. If the line is specified as <code>KIconst KIconst1 KIconst2 KIconst3 KIconst4 KIconst5 KIconst6 KIconst7 KIconst8 KIconst9</code>, then the values <code>KIconst1</code>, <code>KIconst2</code>, <code>KIconst3</code>, <code>KIconst4</code>, <code>KIconst5</code>, <code>KIconst6</code>, <code>KIconst7</code>, <code>KIconst8</code>, and <code>KIconst9</code> are respectively assigned as the <span>$xx$</span>-, <span>$xy$</span>-, <span>$xz$</span>-, <span>$yx$</span>- <span>$yy$</span>-, <span>$yz$</span>-, <span>$zx$</span>-, <span>$zy$</span>-, and <span>$zz$</span>-components of a general tensor, which is then symmetrized, following which (as in the case with 6 values specified) its eigenvectors are preserved but its eigenvalues are replaced by their absolute values (if needed) to yield a real-symmetric positive-definite tensor spring constant constraint along general orthonormal axes in 3 dimensions.</p><p>The lines <code>KIconstatom1 KIconstatom1val</code> and <code>KIconstatom2 KIconstatom2val</code> specify which atoms are to be constrained. Both <code>KIconstatom1val</code> and <code>KIconstatom2val</code> are to be specified as integers between 1 and <span>$N_{n}$</span> if the molecular body labeled <span>$n$</span> has <span>$N_{n}$</span> atoms (in the example above, <code>KIconstatom1val</code> is <code>1</code> and <code>KIconstatom2val</code> is <code>2</code>): any specification outside of this range, or any issues like <code>KIconstatom1val</code> being larger than or equal to <code>KIconstatom2val</code>, are dealt with by appropriately setting <code>KIconstatom1val</code> to 1 or <code>KIconstatom2val</code> to <span>$N_{n}$</span>. These are optional keywords: in their absence, the aforementioned default values of 1 and <span>$N_{n}$</span> are used. Furthermore, for Bloch periodic boundary conditions, only <code>KIconstatom1val</code> is used. Currently, AARMBEM.jl uses the same artificial spring constant constraint for both atoms in a molecular body, and does not support setting separate constraints for different screened nuclear oscillators in a given molecular body.</p><p>The only time when a molecular body may be specified without all of this data is if it is a duplicate of another molecular body. Such a specification may be written as</p><pre><code class="language-none">MOL mol2
DUPLICATE mol1
ENDMOL</code></pre><p>where the keyword <span>$DUPLICATE$</span> (case sensitive) is followed by a space and then the exact string label of another molecular body, to say that these share all of their material properties and only differ in position or orientation. Any number of molecular bodies may be listed as duplicates of a given molecule body. However, the molecular label string must not itself be a duplicate (i.e. it must correspond to a molecular body whose properties are explicitly specified), and molecular bodies with explicitly specified properties must be listed before molecular bodies that are duplicates of those. For instance, the following is allowed:</p><pre><code class="language-none">MOL mol1
Qe Qefile1.txt
Me Mefile1.txt
Ke Kefile1.txt
Be Befile1.txt
MI MIfile1.txt
BI BIfile1.txt
KI KIfile1.txt
xyz xyzfile1.txt
Bescale 1.0
KIconst 1.0e3
KIconstatom1 1
KIconstatom2 2
ENDMOL

MOL mol2
DUPLICATE mol1
ENDMOL

MOL mol3
DUPLICATE mol1
ENDMOL

MOL mol4
Qe Qefile4.txt
Me Mefile4.txt
Ke Kefile4.txt
Be Befile4.txt
MI MIfile4.txt
BI BIfile4.txt
KI KIfile4.txt
xyz xyzfile4.txt
Bescale 1.0e4
KIconst 1.0e3
KIconstatom1 1
KIconstatom2 2
ENDMOL

MOL mol5
DUPLICATE mol1
ENDMOL

MOL mol6
DUPLICATE mol4
ENDMOL

MOL mol7
DUPLICATE mol1
ENDMOL</code></pre><p>but neither the following:</p><pre><code class="language-none">MOL mol1
Qe Qefile1.txt
Me Mefile1.txt
Ke Kefile1.txt
Be Befile1.txt
MI MIfile1.txt
BI BIfile1.txt
KI KIfile1.txt
xyz xyzfile1.txt
Bescale 1.0
KIconst 1.0e3
KIconstatom1 1
KIconstatom2 2
ENDMOL

MOL mol2
DUPLICATE mol1
ENDMOL

MOL mol3
DUPLICATE mol4
ENDMOL

MOL mol4
Qe Qefile4.txt
Me Mefile4.txt
Ke Kefile4.txt
Be Befile4.txt
MI MIfile4.txt
BI BIfile4.txt
KI KIfile4.txt
xyz xyzfile4.txt
Bescale 1.0e4
KIconst 1.0e3
KIconstatom1 1
KIconstatom2 2
ENDMOL

MOL mol5
DUPLICATE mol1
ENDMOL

MOL mol6
DUPLICATE mol4
ENDMOL

MOL mol7
DUPLICATE mol1
ENDMOL</code></pre><p>nor the following:</p><pre><code class="language-none">MOL mol1
Qe Qefile1.txt
Me Mefile1.txt
Ke Kefile1.txt
Be Befile1.txt
MI MIfile1.txt
BI BIfile1.txt
KI KIfile1.txt
xyz xyzfile1.txt
Bescale 1.0
KIconst 1.0e3
KIconstatom1 1
KIconstatom2 2
ENDMOL

MOL mol2
DUPLICATE mol1
ENDMOL

MOL mol3
DUPLICATE mol2
ENDMOL

MOL mol4
Qe Qefile4.txt
Me Mefile4.txt
Ke Kefile4.txt
Be Befile4.txt
MI MIfile4.txt
BI BIfile4.txt
KI KIfile4.txt
xyz xyzfile4.txt
Bescale 1.0e4
KIconst 1.0e3
KIconstatom1 1
KIconstatom2 2
ENDMOL

MOL mol5
DUPLICATE mol1
ENDMOL

MOL mol6
DUPLICATE mol4
ENDMOL

MOL mol7
DUPLICATE mol1
ENDMOL</code></pre><p>are allowed.</p><h2 id="Input-file-structure-1"><a class="docs-heading-anchor" href="#Input-file-structure-1">Input file structure</a><a class="docs-heading-anchor-permalink" href="#Input-file-structure-1" title="Permalink"></a></h2><p>Here, the structures of the input files following the keywords <code>Qe</code>, <code>Me</code>, <code>Ke</code>, and so on are described.</p><p>The files following the keywords <code>Qe</code>, <code>Me</code>, and so on can have any file type, but should be readable as plain text. In particular, the files following the keywords <code>Qe</code>, <code>Me</code>, <code>Ke</code>, and if present, <code>Be</code>, <code>MI</code>, and <code>BI</code> must a list of <span>$N_{n}$</span> values if molecular body <span>$n$</span> has <span>$N_{n}$</span> atoms, formatted as follows:</p><pre><code class="language-none">val1
val2
val3
...
valNn</code></pre><p>so each value should be specified as a real nonnegative floating-point quantity (possibly in scientific notation), and there should be no spaces, blank lines, or extraneous characters. The values in the files following the keywords <code>Me</code> and <code>MI</code> should be in units of kilograms, those in the files following the keywords <code>Be</code> and <code>BI</code> should be in units of kilograms per second, those in the file following the keyword <code>Ke</code> should be in units of newtons per meter, and those in the file following the keyword <code>Qe</code> should be in <span>$\mathrm{kg}^{1/2} \cdot \mathrm{m}^{3/2} \cdot \mathrm{s}^{-1}$</span> obtained by dividing the charge in coulombs by the square root of the vacuum permittivity in SI.</p><p>The file following the keyword <code>xyz</code> can have any file type, but should be readable as plain text. In particular, the file following the keyword <code>xyz</code> must be a list of 3 lines, each of which has <span>$N_{n}$</span> values separated only by commas, if molecular body <span>$n$</span> has <span>$N_{n}$</span> atoms, formatted as follows:</p><pre><code class="language-none">r_{1x},r_{2x},...,r_{Nnx}
r_{1y},r_{2y},...,r_{Nny}
r_{1z},r_{2z},...,r_{Nnz}</code></pre><p>so each value <span>$r_{pi}$</span> should be specified as a real floating-point quantity (possibly in scientific notation), and there should be no spaces, blank lines, or extraneous characters. The values in the file following the keyword <code>xyz</code> should be in units of meters.</p><p>The file following the keyword <code>KI</code> can have any file type, but should be readable as plain text. In particular, the file following the keyword <code>xyz</code> for a compact molecular body labeled <span>$n$</span> must be a list of <span>$3N_{n}$</span> lines, each of which has <span>$3N_{n}$</span> values separated only by commas, if molecular body <span>$n$</span> has <span>$N_{n}$</span> atoms, formatted as follows:</p><pre><code class="language-none">K_{I1x,1x},K_{I1x,1y},K_{I1x,1z},K_{I1x,2x},K_{I1x,2y},K_{I1x,2z},...,K_{I1x,Nnx},K_{I1x,Nny},K_{I1x,Nnz}
K_{I1y,1x},K_{I1y,1y},K_{I1y,1z},K_{I1y,2x},K_{I1y,2y},K_{I1y,2z},...,K_{I1y,Nnx},K_{I1y,Nny},K_{I1y,Nnz}
K_{I1z,1x},K_{I1z,1y},K_{I1z,1z},K_{I1z,2x},K_{I1z,2y},K_{I1z,2z},...,K_{I1z,Nnx},K_{I1z,Nny},K_{I1z,Nnz}
K_{I2x,1x},K_{I2x,1y},K_{I2x,1z},K_{I2x,2x},K_{I2x,2y},K_{I2x,2z},...,K_{I2x,Nnx},K_{I2x,Nny},K_{I2x,Nnz}
K_{I2y,1x},K_{I2y,1y},K_{I2y,1z},K_{I2y,2x},K_{I2y,2y},K_{I2y,2z},...,K_{I2y,Nnx},K_{I2y,Nny},K_{I2y,Nnz}
K_{I2z,1x},K_{I2z,1y},K_{I2z,1z},K_{I2z,2x},K_{I2z,2y},K_{I2z,2z},...,K_{I2z,Nnx},K_{I2z,Nny},K_{I2z,Nnz}
...,...,...,...,...,...,...,...,...,...
K_{INnx,1x},K_{INnx,1y},K_{INnx,1z},K_{INnx,2x},K_{INnx,2y},K_{INnx,2z},...,K_{INnx,Nnx},K_{INnx,Nny},K_{INnx,Nnz}
K_{INny,1x},K_{INny,1y},K_{INny,1z},K_{INny,2x},K_{INny,2y},K_{INny,2z},...,K_{INny,Nnx},K_{INny,Nny},K_{INny,Nnz}
K_{INnz,1x},K_{INnz,1y},K_{INnz,1z},K_{INnz,2x},K_{INnz,2y},K_{INnz,2z},...,K_{INnz,Nnx},K_{INnz,Nny},K_{INnz,Nnz}</code></pre><p>so each value <span>$K_{Ipi,qj}$</span> should be specified as a real floating-point quantity (possibly in scientific notation), and there should be no spaces, blank lines, or extraneous characters. The values in the file following the keyword <code>KI</code> should be in units of newtons per meter.</p><p>There are a few points of note for the file following the keyword <code>KI</code>, if present. For a compact molecular body, it must correspond to a real-symmetric positive-semidefinite matrix, with exactly 6 eigenvalues (or 5 for a purely linear 1-dimensional atomically thin wire-like molecular body) that are effectively zero (i.e. are significantly smaller in magnitude than the remaining eigenvalues, though this is left to the judgment of the user). For a molecular body obeying periodic boundary conditions, there may or may not be nonzero harmonic couplings between screened nuclear oscillators across different unit cells. If there are not, then the above format for the file following the keyword <code>KI</code> should be used. If there are, then a different format should be used. In particular, for 1 periodic dimension, given a unit cell (which may not be the primitive unit cell) with primitive lattice vector <span>$\vec{a}$</span>, any lattice vector may be represented as <span>$\vec{R} = n\vec{a}$</span> for integer <span>$n$</span> (separate from the molecular labels). Likewise, for 2 periodic dimensions, given a unit cell (which may not be the primitive unit cell) with primitive lattice vectors <span>$\vec{a}_{1}$</span> and <span>$\vec{a}_{2}$</span> (which might not be orthogonal), any lattice vector may be represented as <span>$\vec{R} = n_{1} \vec{a}_{1} + n_{2} \vec{a}_{2}$</span> for integers <span>$n_{1}, n_{2}$</span>. In either case, given a base unit cell labeled 0 corresponding to the lattice vector <span>$\vec{R} = 0$</span>, the matrix block <span>$K_{\mathrm{I}(\vec{R}, 0)}$</span> describes couplings from screened nuclear oscillators in unit cell 0 to those in unit cell <span>$\vec{R}$</span> (i.e. <span>$(K_{\mathrm{I}(\vec{R}, 0)})_{pi,qj}$</span> describes the coupling of the screened nuclear oscillator in atom <span>$q$</span> in unit cell 0 along Cartesian direction <span>$j$</span> to the periodic image of the screened nuclear oscillator in atom <span>$p$</span> in unit cell <span>$\vec{R}$</span> along Cartesian direction <span>$i$</span>). Because the unit cell indexing is always of the form <span>$(\vec{R}, 0)$</span> (i.e. atom <span>$q$</span> always lies in unit cell 0), notation may be slightly abused such that in 1 periodic dimension, <span>$K_{\mathrm{I}(n)}$</span> is the matrix block <span>$K_{\mathrm{I}(n\vec{a}, 0)}$</span>, and in 2 periodic dimensions, <span>$K_{\mathrm{I}(n_{1}, n_{2})}$</span> is the matrix block <span>$K_{\mathrm{I}(n_{1} \vec{a}_{1} + n_{2} \vec{a}_{2}, 0)}$</span>. Each of the blocks <span>$K_{\mathrm{I}(n)}$</span> or <span>$K_{\mathrm{I}(n_{1}, n_{2})}$</span> should be <span>$3N_{n} \times 3N_{n}$</span> (where <span>$n$</span> in the context of <span>$N_{n}$</span> is again the molecular label) matrices. Thus, for internuclear couplings in either 1 periodic dimension or 2 periodic dimensions where couplings are only nontrivial along <span>$\vec{a}_{1}$</span>, the matrix blocks should be arranged (with no blank lines in the file) as</p><div>\[\begin{bmatrix}
K_{\mathrm{I}(-n_{1\max}, 0)} \\
\vdots \\
K_{\mathrm{I}(-1, 0)} \\
K_{\mathrm{I}(0, 0)} \\
K_{\mathrm{I}(1, 0)} \\
\vdots \\
K_{\mathrm{I}(n_{1\max}, 0)} 
\end{bmatrix}\]</div><p>(replacing <span>$K_{\mathrm{I}(n_{1}, 0)}$</span> in 2 periodic dimensions with <span>$K_{\mathrm{I}(n)}$</span> in 1 periodic dimension) where <span>$n_{1\max}$</span> (or <span>$n_{\max}$</span>) is the largest unit cell index in either direction along that periodic dimension where internuclear couplings between any atom <span>$p$</span> in that unit cell and any atom <span>$q$</span> in unit cell 0 are nonzero. In 2 periodic dimensions where couplings are only nontrivial along <span>$\vec{a}_{2}$</span>, the matrix blocks should be arranged (through horizontal concatenation with commas as usual, with no other extraneous characters, spaces, or blank lines) as</p><div>\[\begin{bmatrix}
K_{\mathrm{I}(0, -n_{2\max})} &amp; \ldots &amp; K_{\mathrm{I}(0, -1)} &amp; K_{\mathrm{I}(0, 0)} &amp; K_{\mathrm{I}(0, 1)} &amp; \ldots &amp; K_{\mathrm{I}(0, n_{2\max})} 
\end{bmatrix}\]</div><p>where <span>$n_{2\max}$</span> is the largest unit cell index in either direction along that periodic dimension where internuclear couplings between any atom <span>$p$</span> in that unit cell and any atom <span>$q$</span> in unit cell 0 are nonzero. In 2 periodic dimensions where couplings are nontrivial along both primitive lattice vector directions <span>$\vec{a}_{1}$</span> and <span>$\vec{a}_{2}$</span>, the matrix blocks should be arranged (through horizontal concatenation with commas as usual and direct vertical concatenation, with no other extraneous characters, spaces, or blank lines) as</p><div>\[\begin{bmatrix}
K_{\mathrm{I}(-n_{1\max}, -n_{2\max})} &amp; \ldots &amp; K_{\mathrm{I}(-n_{1\max}, -1)} &amp; K_{\mathrm{I}(-n_{1\max}, 0)} &amp; K_{\mathrm{I}(-n_{1\max}, 1)} &amp; \ldots &amp; K_{\mathrm{I}(-n_{1\max}, n_{2\max})} \\
\vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
K_{\mathrm{I}(-1, -n_{2\max})} &amp; \ldots &amp; K_{\mathrm{I}(-1, -1)} &amp; K_{\mathrm{I}(-1, 0)} &amp; K_{\mathrm{I}(-1, 1)} &amp; \ldots &amp; K_{\mathrm{I}(-1, n_{2\max})} \\
K_{\mathrm{I}(0, -n_{2\max})} &amp; \ldots &amp; K_{\mathrm{I}(0, -1)} &amp; K_{\mathrm{I}(0, 0)} &amp; K_{\mathrm{I}(0, 1)} &amp; \ldots &amp; K_{\mathrm{I}(0, n_{2\max})} \\
K_{\mathrm{I}(1, -n_{2\max})} &amp; \ldots &amp; K_{\mathrm{I}(1, -1)} &amp; K_{\mathrm{I}(1, 0)} &amp; K_{\mathrm{I}(1, 1)} &amp; \ldots &amp; K_{\mathrm{I}(1, n_{2\max})} \\
\vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
K_{\mathrm{I}(n_{1\max}, -n_{2\max})} &amp; \ldots &amp; K_{\mathrm{I}(n_{1\max}, -1)} &amp; K_{\mathrm{I}(n_{1\max}, 0)} &amp; K_{\mathrm{I}(n_{1\max}, 1)} &amp; \ldots &amp; K_{\mathrm{I}(n_{1\max}, n_{2\max})} 
\end{bmatrix}\]</div><p>where <span>$n_{1\max}$</span> and <span>$n_{2\max}$</span> are the largest unit cell indices in either direction along that corresponding periodic dimension where internuclear couplings between any atom <span>$p$</span> in that unit cell and any atom <span>$q$</span> in unit cell 0 are nonzero.</p><p>Whether for compact or Bloch periodic molecular bodies, the matrix <span>$K_{\mathrm{I}}$</span> in real space must also satisfy two other properties. Every off-diagonal <span>$3\times 3$</span> tensor <span>$\mathbb{K}_{\mathrm{I}pq}$</span> for atoms <span>$p \neq q$</span> (and for Bloch periodic molecular bodies, this includes tensor blocks in the block matrices <span>$K_{\mathrm{I}(\vec{R}, 0)}$</span> for <span>$\vec{R} \neq 0$</span>, so atom <span>$q$</span> would be in unit cell 0 while atom <span>$p$</span> may be in another unit cell <span>$\vec{R}$</span>) must be real-symmetric negative-definite. Furthermore, the <span>$3\times 3$</span> tensors in the diagonal blocks must satisfy <span>$K_{\mathrm{I}qi,qj} = -\sum_{p} K_{\mathrm{I}pi,qj}$</span>, (for Cartesian tensor indices <span>$i, j$</span>) where for a compact molecular body atoms <span>$p, q$</span> are within the body itself while for a periodic molecular body with nontrivial couplings to other unit cells <span>$q$</span> lies within unit cell 0 while <span>$p$</span> runs over all other atoms in all unit cells (including the periodic image of <span>$q$</span> in other unit cells).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For all of these data files, AARMBEM.jl does not check that the corresponding lists have the correct number of elements, and will simply throw an error if the formatting or list lengths are incorrect (i.e. it does not try to correct the error).</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>As a reminder, AARMBEM.jl does not perform the DFT calculations needed to generate the relevant molecular input data files. This must be done separately.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>AARMBEM.jl does not check whether the matrix <span>$K_{\mathrm{I}}$</span> in real space obeys the rules of positive-definiteness overall, negative-definiteness for the off-diagonal <span>$3\times 3$</span> tensor blocks, or the summation constraint for the diagonal <span>$3\times 3$</span> tensor blocks. These need to be verified, and enforced if need be, beforehand. Furthermore, if <span>$K_{\mathrm{I}}$</span> is computed via DFT, such calculations will typically yield nontrivial couplings between all pairs of atoms at arbitrary distances (though the magnitudes will decrease significantly with increasing distance), and the results may lead to numerical error depending on the extent to which any of these conditions are violated; as a result, it may be necessary to symmetrize off-diagonal <span>$3\times 3$</span> tensor blocks manually, set couplings beyond a certain bond distance to zero, and recompute the <span>$3\times 3$</span> diagonal tensor blocks manually.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../implementation/ewaldwarning.html">« Warning: Ewald summation</a><a class="docs-footer-nextpage" href="transfiles.html">Transformation files »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 27 May 2020 14:09">Wednesday 27 May 2020</span>. Using Julia version 1.0.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
